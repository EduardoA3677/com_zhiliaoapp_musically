(()=>{var Ur=Object.create;var Yt=Object.defineProperty,kr=Object.defineProperties,jr=Object.getOwnPropertyDescriptor,Fr=Object.getOwnPropertyDescriptors,$r=Object.getOwnPropertyNames,ft=Object.getOwnPropertySymbols,Br=Object.getPrototypeOf,zt=Object.prototype.hasOwnProperty,In=Object.prototype.propertyIsEnumerable;var Tn=(r,e,t)=>e in r?Yt(r,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[e]=t,N=(r,e)=>{for(var t in e||(e={}))zt.call(e,t)&&Tn(r,t,e[t]);if(ft)for(var t of ft(e))In.call(e,t)&&Tn(r,t,e[t]);return r},Ue=(r,e)=>kr(r,Fr(e));var On=(r,e)=>{var t={};for(var n in r)zt.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&ft)for(var n of ft(r))e.indexOf(n)<0&&In.call(r,n)&&(t[n]=r[n]);return t};var Qe=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports);var Gr=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of $r(e))!zt.call(r,o)&&o!==t&&Yt(r,o,{get:()=>e[o],enumerable:!(n=jr(e,o))||n.enumerable});return r};var Dn=(r,e,t)=>(t=r!=null?Ur(Br(r)):{},Gr(e||!r||!r.__esModule?Yt(t,"default",{value:r,enumerable:!0}):t,r));var Nn=(r,e,t)=>new Promise((n,o)=>{var i=c=>{try{a(t.next(c))}catch(l){o(l)}},s=c=>{try{a(t.throw(c))}catch(l){o(l)}},a=c=>c.done?n(c.value):Promise.resolve(c.value).then(i,s);a((t=t.apply(r,e)).next())});var Mn=Qe((Io,Ln)=>{"use strict";function _t(){}var ke=null,je={};function Vr(r){try{return r.then}catch(e){return ke=e,je}}function qr(r,e){try{return r(e)}catch(t){return ke=t,je}}function Hr(r,e,t){try{r(e,t)}catch(n){return ke=n,je}}function Wr(r){if(!r)return"";let e=r.indexOf(`
`);return e===-1?r:r.substring(e+1)}Ln.exports=r=>{var e=r.nextTick;function t(d){if(this.__createStack=Wr(new Error("Promise creation stack").stack),typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof d!="function")throw new TypeError("Promise constructor's argument is not a function");this._deferredState=0,this._state=0,this._value=null,this._deferreds=null,d!==_t&&h(d,this)}t._onHandle=null,t._onReject=null,t._noop=_t,t.prototype.then=function(d,p){if(this.constructor!==t)return n(this,d,p);var u=new t(_t);return o(this,new l(d,p,u)),u};function n(d,p,u){return new d.constructor(function(_,f){var v=new t(_t);v.then(_,f),o(d,new l(p,u,v))})}function o(d,p){for(;d._state===3;)d=d._value;if(t._onHandle&&t._onHandle(d),d._state===0){if(d._deferredState===0){d._deferredState=1,d._deferreds=p;return}if(d._deferredState===1){d._deferredState=2,d._deferreds=[d._deferreds,p];return}d._deferreds.push(p);return}i(d,p)}function i(d,p){e(function(){var u=d._state===1?p.onFulfilled:p.onRejected;if(u===null){d._state===1?s(p.promise,d._value):a(p.promise,d._value);return}var _=qr(u,d._value);_===je?a(p.promise,ke):s(p.promise,_)})}function s(d,p){if(p===d)return a(d,new TypeError("A promise cannot be resolved with itself."));if(p&&(typeof p=="object"||typeof p=="function")){var u=Vr(p);if(u===je)return a(d,ke);if(u===d.then&&p instanceof t){d._state=3,d._value=p,c(d);return}else if(typeof u=="function"){h(u.bind(p),d);return}}d._state=1,d._value=p,c(d)}function a(d,p){d._state=2,d._value=p,t._onReject&&t._onReject(d,p),c(d)}function c(d){if(d._deferredState===1&&(o(d,d._deferreds),d._deferreds=null),d._deferredState===2){for(var p=0;p<d._deferreds.length;p++)o(d,d._deferreds[p]);d._deferreds=null}}function l(d,p,u){this.onFulfilled=typeof d=="function"?d:null,this.onRejected=typeof p=="function"?p:null,this.promise=u}function h(d,p){var u=!1,_=Hr(d,function(f){u||(u=!0,s(p,f))},function(f){u||(u=!0,a(p,f))});!u&&_===je&&(u=!0,a(p,ke))}return t}});var Un=Qe((Oo,wn)=>{"use strict";wn.exports=r=>{var e=a(!0),t=a(!1),n=a(null),o=a(void 0),i=a(0),s=a("");function a(l){var h=new r(r._noop);return h._state=1,h._value=l,h}r.resolve=function(l){if(l instanceof r)return l;if(l===null)return n;if(l===void 0)return o;if(l===!0)return e;if(l===!1)return t;if(l===0)return i;if(l==="")return s;if(typeof l=="object"||typeof l=="function")try{var h=l.then;if(typeof h=="function")return new r(h.bind(l))}catch(d){return new r(function(p,u){u(d)})}return a(l)};var c=function(l){return typeof Array.from=="function"?(c=Array.from,Array.from(l)):(c=function(h){return Array.prototype.slice.call(h)},Array.prototype.slice.call(l))};return r.all=function(l){var h=c(l);return new r(function(d,p){if(h.length===0)return d([]);var u=h.length;function _(v,x){if(x&&(typeof x=="object"||typeof x=="function"))if(x instanceof r&&x.then===r.prototype.then){for(;x._state===3;)x=x._value;if(x._state===1)return _(v,x._value);x._state===2&&p(x._value),x.then(function(I){_(v,I)},p);return}else{var T=x.then;if(typeof T=="function"){var C=new r(T.bind(x));C.then(function(I){_(v,I)},p);return}}h[v]=x,--u===0&&d(h)}for(var f=0;f<h.length;f++)_(f,h[f])})},r.reject=function(l){return new r(function(h,d){d(l)})},r.race=function(l){return new r(function(h,d){c(l).forEach(function(p){r.resolve(p).then(h,d)})})},r.prototype.catch=function(l){return this.then(null,l)},r.prototype.done=function(l,h){var d=arguments.length?this.then.apply(this,arguments):this;d.then(null,function(p){setTimeout(function(){throw p},0)})},r.prototype.finally=function(l){return this.then(function(h){return r.resolve(l()).then(function(){return h})},function(h){return r.resolve(l()).then(function(){throw h})})},r}});var jn=Qe((Do,kn)=>{"use strict";kn.exports=(r,e,t)=>{var n=[ReferenceError,TypeError,RangeError],o=!1;function i(){o=!1,r._onHandle=null,r._onReject=null}function s(l){l=l||{},o&&i(),o=!0;var h=0,d=0,p={};r._onHandle=function(f){f._state===2&&p[f._rejectionId]&&(p[f._rejectionId].logged?_(f._rejectionId):t&&t(p[f._rejectionId].timeout),delete p[f._rejectionId])},r._onReject=function(f,v){f._deferredState===0&&(f._rejectionId=h++,p[f._rejectionId]={displayId:null,error:v,timeout:e(u.bind(null,f),0),logged:!1})};function u(f){let v=f._rejectionId;if(l.allRejections||c(p[v].error,l.whitelist||n))if(p[v].displayId=d++,l.onUnhandled){if(p[v].logged=!0,p[v].error&&!(p[v].error instanceof Error)){let x=new Error(JSON.stringify(p[v].error));x.stack=f.__createStack,p[v].error=x}l.onUnhandled(p[v].displayId,p[v].error)}else p[v].logged=!0,a(p[v].displayId,p[v].error)}function _(f){p[f].logged&&(l.onHandled?l.onHandled(p[f].displayId,p[f].error):p[f].onUnhandled)}return r}function a(l,h){var d=(h&&(h.stack||h))+"";d.split(`
`).forEach(function(p){})}function c(l,h){return h.some(function(d){return l instanceof d})}return{enable:s,disable:i}}});var $n=Qe((No,Fn)=>{"use strict";var Jr=Mn(),Kr=Un(),Qr=jn(),Yr=new Function("return this")();Yr.getPromise=Fn.exports.getPromise=r=>{var e=r.setTimeout,t=r.onUnhandled,n=r.clearTimeout,o=r.nextTick||(s=>{e(s,0)}),i=Jr({nextTick:o});return i=Kr(i),i=Qr(i,e,n).enable({allRejections:!0,onUnhandled:t}),i}});var Gn=Qe((Po,Xt)=>{var Bn=function(r){"use strict";var e=Object.prototype,t=e.hasOwnProperty,n,o=typeof Symbol=="function"?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag";function c(E,m,g){return Object.defineProperty(E,m,{value:g,enumerable:!0,configurable:!0,writable:!0}),E[m]}try{c({},"")}catch(E){c=function(m,g,S){return m[g]=S}}function l(E,m,g,S){var b=m&&m.prototype instanceof v?m:v,U=Object.create(b.prototype),K=new O(S||[]);return U._invoke=w(E,g,K),U}r.wrap=l;function h(E,m,g){try{return{type:"normal",arg:E.call(m,g)}}catch(S){return{type:"throw",arg:S}}}var d="suspendedStart",p="suspendedYield",u="executing",_="completed",f={};function v(){}function x(){}function T(){}var C={};C[i]=function(){return this};var I=Object.getPrototypeOf,R=I&&I(I(ee([])));R&&R!==e&&t.call(R,i)&&(C=R);var V=T.prototype=v.prototype=Object.create(C);x.prototype=V.constructor=T,T.constructor=x,x.displayName=c(T,a,"GeneratorFunction");function L(E){["next","throw","return"].forEach(function(m){c(E,m,function(g){return this._invoke(m,g)})})}r.isGeneratorFunction=function(E){var m=typeof E=="function"&&E.constructor;return m?m===x||(m.displayName||m.name)==="GeneratorFunction":!1},r.mark=function(E){return Object.setPrototypeOf?Object.setPrototypeOf(E,T):(E.__proto__=T,c(E,a,"GeneratorFunction")),E.prototype=Object.create(V),E},r.awrap=function(E){return{__await:E}};function P(E,m){function g(U,K,Q,ne){var Y=h(E[U],E,K);if(Y.type==="throw")ne(Y.arg);else{var Qt=Y.arg,Ke=Qt.value;return Ke&&typeof Ke=="object"&&t.call(Ke,"__await")?m.resolve(Ke.__await).then(function(Ae){g("next",Ae,Q,ne)},function(Ae){g("throw",Ae,Q,ne)}):m.resolve(Ke).then(function(Ae){Qt.value=Ae,Q(Qt)},function(Ae){return g("throw",Ae,Q,ne)})}}var S;function b(U,K){function Q(){return new m(function(ne,Y){g(U,K,ne,Y)})}return S=S?S.then(Q,Q):Q()}this._invoke=b}L(P.prototype),P.prototype[s]=function(){return this},r.AsyncIterator=P,r.async=function(E,m,g,S,b){b===void 0&&(b=Promise);var U=new P(l(E,m,g,S),b);return r.isGeneratorFunction(m)?U:U.next().then(function(K){return K.done?K.value:U.next()})};function w(E,m,g){var S=d;return function(U,K){if(S===u)throw new Error("Generator is already running");if(S===_){if(U==="throw")throw K;return we()}for(g.method=U,g.arg=K;;){var Q=g.delegate;if(Q){var ne=J(Q,g);if(ne){if(ne===f)continue;return ne}}if(g.method==="next")g.sent=g._sent=g.arg;else if(g.method==="throw"){if(S===d)throw S=_,g.arg;g.dispatchException(g.arg)}else g.method==="return"&&g.abrupt("return",g.arg);S=u;var Y=h(E,m,g);if(Y.type==="normal"){if(S=g.done?_:p,Y.arg===f)continue;return{value:Y.arg,done:g.done}}else Y.type==="throw"&&(S=_,g.method="throw",g.arg=Y.arg)}}}function J(E,m){var g=E.iterator[m.method];if(g===n){if(m.delegate=null,m.method==="throw"){if(E.iterator.return&&(m.method="return",m.arg=n,J(E,m),m.method==="throw"))return f;m.method="throw",m.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}var S=h(g,E.iterator,m.arg);if(S.type==="throw")return m.method="throw",m.arg=S.arg,m.delegate=null,f;var b=S.arg;if(!b)return m.method="throw",m.arg=new TypeError("iterator result is not an object"),m.delegate=null,f;if(b.done)m[E.resultName]=b.value,m.next=E.nextLoc,m.method!=="return"&&(m.method="next",m.arg=n);else return b;return m.delegate=null,f}L(V),c(V,a,"Generator"),V[i]=function(){return this},V.toString=function(){return"[object Generator]"};function ut(E){var m={tryLoc:E[0]};1 in E&&(m.catchLoc=E[1]),2 in E&&(m.finallyLoc=E[2],m.afterLoc=E[3]),this.tryEntries.push(m)}function Me(E){var m=E.completion||{};m.type="normal",delete m.arg,E.completion=m}function O(E){this.tryEntries=[{tryLoc:"root"}],E.forEach(ut,this),this.reset(!0)}r.keys=function(E){var m=[];for(var g in E)m.push(g);return m.reverse(),function S(){for(;m.length;){var b=m.pop();if(b in E)return S.value=b,S.done=!1,S}return S.done=!0,S}};function ee(E){if(E){var m=E[i];if(m)return m.call(E);if(typeof E.next=="function")return E;if(!isNaN(E.length)){var g=-1,S=function b(){for(;++g<E.length;)if(t.call(E,g))return b.value=E[g],b.done=!1,b;return b.value=n,b.done=!0,b};return S.next=S}}return{next:we}}r.values=ee;function we(){return{value:n,done:!0}}return O.prototype={constructor:O,reset:function(E){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(Me),!E)for(var m in this)m.charAt(0)==="t"&&t.call(this,m)&&!isNaN(+m.slice(1))&&(this[m]=n)},stop:function(){this.done=!0;var E=this.tryEntries[0],m=E.completion;if(m.type==="throw")throw m.arg;return this.rval},dispatchException:function(E){if(this.done)throw E;var m=this;function g(ne,Y){return U.type="throw",U.arg=E,m.next=ne,Y&&(m.method="next",m.arg=n),!!Y}for(var S=this.tryEntries.length-1;S>=0;--S){var b=this.tryEntries[S],U=b.completion;if(b.tryLoc==="root")return g("end");if(b.tryLoc<=this.prev){var K=t.call(b,"catchLoc"),Q=t.call(b,"finallyLoc");if(K&&Q){if(this.prev<b.catchLoc)return g(b.catchLoc,!0);if(this.prev<b.finallyLoc)return g(b.finallyLoc)}else if(K){if(this.prev<b.catchLoc)return g(b.catchLoc,!0)}else if(Q){if(this.prev<b.finallyLoc)return g(b.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(E,m){for(var g=this.tryEntries.length-1;g>=0;--g){var S=this.tryEntries[g];if(S.tryLoc<=this.prev&&t.call(S,"finallyLoc")&&this.prev<S.finallyLoc){var b=S;break}}b&&(E==="break"||E==="continue")&&b.tryLoc<=m&&m<=b.finallyLoc&&(b=null);var U=b?b.completion:{};return U.type=E,U.arg=m,b?(this.method="next",this.next=b.finallyLoc,f):this.complete(U)},complete:function(E,m){if(E.type==="throw")throw E.arg;return E.type==="break"||E.type==="continue"?this.next=E.arg:E.type==="return"?(this.rval=this.arg=E.arg,this.method="return",this.next="end"):E.type==="normal"&&m&&(this.next=m),f},finish:function(E){for(var m=this.tryEntries.length-1;m>=0;--m){var g=this.tryEntries[m];if(g.finallyLoc===E)return this.complete(g.completion,g.afterLoc),Me(g),f}},catch:function(E){for(var m=this.tryEntries.length-1;m>=0;--m){var g=this.tryEntries[m];if(g.tryLoc===E){var S=g.completion;if(S.type==="throw"){var b=S.arg;Me(g)}return b}}throw new Error("illegal catch attempt")},delegateYield:function(E,m,g){return this.delegate={iterator:ee(E),resultName:m,nextLoc:g},this.method==="next"&&(this.arg=n),f}},r}(typeof Xt=="object"?Xt.exports:{});try{regeneratorRuntime=Bn}catch(r){Function("r","regeneratorRuntime = r")(Bn)}});var Pn=new Function("return this;")();Pn.globalThis=Pn;var Jh=Dn($n()),Kh=Dn(Gn());var zr=function(){return this||(0,eval)("this")}(),re=zr;function mt(r){return nativeConsole}var Xr=function(){return this||(0,eval)("this")}(),Mo=mt(`groupId:${Xr.groupId||"-1"}`),Zt=nativeConsole;function Te(r,e){return Object.prototype.hasOwnProperty.call(r||{},e)}function D(r){let e=typeof r;return e!=="object"?e:Array.isArray(r)?"array":r==null?"null":r instanceof Date?"date":r instanceof RegExp?"regExp":"object"}function z(r){return typeof r=="string"}function A(r){return D(r)==="object"}function j(r){return D(r)==="function"}function ge(r){return D(r)==="array"}function ve(r){return r===null}function Ye(r){return r===void 0}function Et(r){return Ye(r)||ve(r)}function yt(r){switch(Object.prototype.toString.call(r)){case"[object Error]":return!0;case"[object Exception]":return!0;case"[object DOMException]":return!0;default:return Zr(r,Error)}}function Zr(r,e){try{return r instanceof e}catch(t){return!1}}function Vn(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,r=>{let e=16*Math.random()|0;return(r==="x"?e:3&e|8).toString(16)})}function ue(){}function qn(r,e){if(Array.isArray(r)){let t=r.length;for(let n=t-1;n>=0;n--)e(r[n])}else throw new Error("forEachRight ERROR: first params must be array.")}var Hn=r=>{let e={};return A(r)&&Object.keys(r).forEach(t=>{e[t]=r[t]}),e},Fe=(r,e,t=!1)=>{let n={};return A(r)&&Object.keys(r).forEach(o=>{n[o]=r[o]}),A(e)&&Object.keys(e).forEach(o=>{(!ve(e[o])||!t)&&(n[o]=e[o])}),n};var te=Zt;var gt;(function(r){r[r.Fatal=0]="Fatal",r[r.Error=1]="Error",r[r.Warn=2]="Warn"})(gt||(gt={}));var vt=class extends Error{constructor(e,t){super(e),t&&(this.stack=t)}},xt=class extends vt{constructor(){super(...arguments),this.kind="INTERNAL_ERROR"}},en=class extends vt{constructor(){super(...arguments),this.kind="USER_ERROR"}};var le=class extends en{constructor(){super(...arguments),this.name="USER_RUNTIME_ERROR"}},xe=class extends xt{constructor(){super(...arguments),this.name="INTERNAL_RUNTIME_ERROR"}};var Ct=class extends xt{constructor(){super(...arguments),this.name="INVOKE_ERROR"}},oe=class extends Error{constructor(e){super(`APP-SERVICE-Engine: ${e}`),this.type="AppServiceEngineKnownError"}};var X="__Card__",fe="app-service.js",Wn="LynxGetSourceMapReleaseError",$e={filename:"lynx_core",slot:"3dbca97f661c0a8be969849a39e55cb2fa4323c8",release:"3.6.1-rc.22-nopgo"};var bt=class{constructor(){this.observersFunc=[]}registerObserver(e){if(this.observersFunc.includes(e))return te.log("Subject: Observer has been attached already.");this.observersFunc.push(e)}removeObserver(e){let t=this.observersFunc.indexOf(e);if(t===-1)return te.log("Subject: Nonexistent observer.");this.observersFunc.splice(t,1)}notifyDataChange(e){this.observersFunc.forEach(t=>{if(typeof t=="function")try{t(e)}catch(n){te.log("SharedData change and notifyDataChange error info:"+n)}})}};re.multiApps={};re.currentAppId="";re.globComponentRegistPath="";re.sharedData={};re.globDynamicComponentEntry=X;re.shareDataSubject=new bt;re.TaroLynx={};re.bundleSupportLoadScript=!0;var{loadScript:oi}=re,y=re;var Be;(function(r){r[r.TypescriptBundleSupportLoadScript=45]="TypescriptBundleSupportLoadScript",r[r.TypescriptHeliumCreateCanvasWait=89]="TypescriptHeliumCreateCanvasWait"})(Be||(Be={}));var tn;function q(r){tn===void 0&&(tn=typeof te.alog=="function"),tn&&te.alog("[LynxJSSDK]"+r)}var eo=/\d+/,Ce=class r{constructor(e){this.major=0,this.minor=0,this.revision=0,this.build=0,e=String(e),[this.major=0,this.minor=0,this.revision=0,this.build=0]=e.split(".").map(t=>{let n=eo.exec(t);return n&&n.length>0?+n[0]:0})}gt(e){return typeof e=="string"&&(e=new r(e)),this.major>e.major?!0:this.major<e.major?!1:this.minor>e.minor?!0:this.minor<e.minor?!1:this.revision>e.revision?!0:this.revision<e.revision?!1:this.build>e.build?!0:(this.build<e.build,!1)}eq(e){return typeof e=="string"&&(e=new r(e)),this.major===e.major&&this.minor===e.minor&&this.revision===e.revision&&this.build===e.build}lt(e){return this.eq(e)?!1:!this.gt(e)}gte(e){return this.eq(e)||this.gt(e)}lte(e){return this.eq(e)||this.lt(e)}},Ie=Ce,li=new Ce("2.4"),Jn=new Ce("2.7"),Kn=new Ce("2.9"),Qn=new Ce("2.12"),Yn=new Ce("2.14");var St=class{constructor(){this.id=1,this.callbacks=new Map,this.taskIdToCallbackIds=new Map}nextId(){if(this.callbacks)return this.id++}addCallback(e){if(!this.callbacks)return;let t=this.nextId();if(t!==void 0)return this.callbacks.set(t,e),t}invokeCallback(e,t,...n){if(!this.callbacks)return;let o=this.callbacks.get(t);if(o)try{o.apply(o,n)}finally{e&&this.removeCallback(t)}}removeCallback(e){if(this.callbacks){if(typeof e!="number")return;this.callbacks.delete(e)}}addTaskIdAndCallbackId(e,t){this.taskIdToCallbackIds&&this.taskIdToCallbackIds.set(e,t)}removeCallbackByTaskId(e){if(this.taskIdToCallbackIds&&this.callbacks){let t=this.taskIdToCallbackIds.get(e);this.taskIdToCallbackIds.delete(e),this.removeCallback(t)}}removeTaskId(e){this.taskIdToCallbackIds&&e!==void 0&&this.taskIdToCallbackIds.delete(e)}destroy(){this.callbacks=void 0,this.taskIdToCallbackIds=void 0}};function ie(r,e,t){let{originError:n,errorCode:o,errorLevel:i,runType:s=$e}=t!=null?t:{};te.error("The following error occurred in the JSRuntime:"),te.error(`${r==null?void 0:r.message}
${r==null?void 0:r.stack}`),r.cause=A(r.cause)?JSON.stringify(r.cause):r.cause;try{e.reportException(r,Ue(N({},s),{buildVersion:"3.6.1-rc.22-nopgo",versionCode:"3.6.1-rc.22-nopgo",errorCode:o,errorLevel:i}))}catch(a){te.error(`reportError err:
`,a)}}function nn(r,e,t=$e,n,o){return ie(r,e,{runType:t,originError:n,__sourcemap__release__:o.__sourcemap__release__})}function $(r,e,t,n=$e){return j(t)?zn("USER_ERROR",r,t,e,n):ue}function zn(r="INTERNAL_ERROR",e,t,n,o){return function(...s){try{return t.apply(this,s)}catch(a){let c=`${e} 
${a.message}`;t.name!=="onError"&&typeof n.onError=="function"&&n.onError(`Card ${t.name} exec error:${c}
${a.stack}`,a);let l=r==="INTERNAL_ERROR"?new xe(c,a.stack):new le(c,a.stack);te.log(`wrapError-${e}`,l),ie(l,n._nativeApp,{runType:o,__sourcemap__release__:n.__sourcemap__release__,getSourceMapRelease:n.getSourceMapRelease})}}}function Xn(r,e,t,n=$e){return j(t)?zn("INTERNAL_ERROR",r,t,e,n):ue}var ze=class{constructor(e,t){this.getApp=e,this.getNativeApp=t,this.setSourceMapRelease=n=>{if(yt(n)&&n.name===k.kGetSourceMapReleaseErrorName&&z(n.message)&&z(n.stack)){this.getNativeApp().__SetSourceMapRelease({name:n.name,message:n.message,stack:n.stack});return}q(`setSourceMapRelease failed with error: ${JSON.stringify(n)}`)},this.getSourceMapRelease=n=>{let o=this.getNativeApp().__GetSourceMapRelease(n);return o||(o=this.getNativeApp().__GetSourceMapRelease(k.kDefaultSourceMapURL)),o},this.getApp=e,this.getNativeApp=t}rebind(e){this.getApp=e}};var be=class{constructor(e){this._internal_callLynxSetModule=e,this._events=new Map}getEventsSize(e){var t;return(t=this._events.get(e))==null?void 0:t.length}setCallLynxSetModule(e){this._internal_callLynxSetModule=e}addListener(e,t,n){let o=this._events.get(e);e=="keyboardstatuschanged"&&this._internal_callLynxSetModule&&this._internal_callLynxSetModule("switchKeyBoardDetect",[!0]),o?o.push({listener:t,context:n}):this._events.set(e,[{listener:t,context:n}])}removeListener(e,t){if(typeof t!="function")throw new Error("removeListener only takes instances of Function");let n=this._events.get(e),o=0;Array.isArray(n)&&n.some(s=>{if(t===s.listener)return!0;o++})&&n.splice(o,1),e=="keyboardstatuschanged"&&this._internal_callLynxSetModule&&this._internal_callLynxSetModule("switchKeyBoardDetect",[!1])}emit(e,t){let n=this._events.get(e);Array.isArray(n)&&n.forEach(o=>{let{listener:i,context:s}=o;typeof i=="function"&&i.apply(s||this,t)})}removeAllListeners(e){if(typeof e=="string"){this._events.delete(e);return}this._events=new Map}trigger(e,t){let n=this._events.get(e);Array.isArray(n)&&(typeof t=="string"&&(t=JSON.parse(t)),n.forEach(o=>{let{listener:i,context:s}=o;typeof i=="function"&&i.call(s||this,t)}))}toggle(e,...t){this.emit(e,t)}};function rn(){return new be}var Rt=class{constructor(){this._beforePublishEvent=new on}},on=class extends be{add(e,t,n){return super.addListener(e,t,n),this}remove(e,t){return super.removeListener(e,t),this}};var _e=be;var At=class{constructor(e){this._textInfoModule=void 0,this.getTextInfo=(t,n)=>(this._textInfoModule===void 0&&(this._textInfoModule=this._nativeModules.LynxTextInfoModule),this._textInfoModule&&this._textInfoModule.getTextInfo?this._textInfoModule.getTextInfo(t,n):{width:t.length}),this._nativeModules=e}};var Tt=class{constructor(e){this.resumeExposure=()=>{this._exposureModule.resumeExposure()},this.stopExposure=t=>{this._exposureModule.stopExposure(t)},this.setObserverFrameRate=t=>{this._exposureModule.setObserverFrameRate(t)},this._nativeModules=e,this._exposureModule=this._nativeModules.LynxExposureModule}};var sn=class{constructor(e,t){this._selector=e,this._callback=t}invokeCallback(e){this._callback(e)}},an=class{constructor(e,t,n){this._id=e,this._intersectionObserverModule=t,this._manager=n,this._observationTargets=[],this._defaultMargins={left:0,right:0,top:0,bottom:0}}relativeTo(e,t){return this._intersectionObserverModule.relativeTo(this._id,e,t||this._defaultMargins),this}relativeToViewport(e){return this._intersectionObserverModule.relativeToViewport(this._id,e||this._defaultMargins),this}relativeToScreen(e){return this._intersectionObserverModule.relativeToScreen(this._id,e||this._defaultMargins),this}observe(e,t){this._observationTargets.push(new sn(e,t)),this._intersectionObserverModule.observe(this._id,e,this._observationTargets.length-1)}disconnect(){this._intersectionObserverModule.disconnect(this._id),this._manager.removeObserver(this._id)}invokeCallback(e,t){e<this._observationTargets.length&&this._observationTargets[e].invokeCallback(t)}},It=class{constructor(e){this._nativeModules=e,this._observerId=0,this._observers={},this._defaultOptions={thresholds:[0],initialRatio:0,observeAll:!1}}createIntersectionObserver(e,t){let n=this._nativeModules.IntersectionObserverModule,o=new an(this._observerId,n,this);return this._observers[this._observerId]=o,n.createIntersectionObserver(this._observerId,e,t||this._defaultOptions),this._observerId++,o}getObserver(e){return this._observers[e]}removeObserver(e){this._observers[e]=null}};var Zn={onPerformance:"lynx.performance.onPerformanceEvent"},Ot=class{constructor(e,t){this._emitter=e,this._onPerformance=t,this._observedNames=[]}observe(e){this._observedNames.length>0||(this._observedNames=e,this._emitter.addListener(Zn.onPerformance,this.onPerformanceEvent.bind(this)))}disconnect(){this._observedNames=[],this._emitter.removeListener(Zn.onPerformance,this.onPerformanceEvent.bind(this))}onPerformanceEvent(e){if(this._observedNames.length===0)return;let t=e.entryType+"."+e.name;(this._observedNames.includes(t)||this._observedNames.includes(e.entryType))&&this._onPerformance(e)}};var Ge={onSetup:"lynx.performance.timing.onSetup",onUpdate:"lynx.performance.timing.onUpdate"},Xe=class{constructor(e,t){this._emitter=e,this._generatePipelineOptions=t.generatePipelineOptions,this._onPipelineStart=t.onPipelineStart,this._markTiming=t.markPipelineTiming,this._profileStart=t.profileStart,this._profileEnd=t.profileEnd,this._profileMark=t.profileMark,this._profileFlowId=t.profileFlowId,this._isProfileRecording=t.isProfileRecording,this._bindPipelineIdWithTimingFlag=t.bindPipelineIdWithTimingFlag}profileStart(e,t){this._profileStart(e,t)}profileEnd(){this._profileEnd()}profileMark(e,t){this._profileMark(e,t)}profileFlowId(){return this._profileFlowId()}createObserver(e){return new Ot(this._emitter,e)}isProfileRecording(){return this._isProfileRecording()}addTimingListener(e){this._emitter.addListener(Ge.onSetup,e.onSetup,e),this._emitter.addListener(Ge.onUpdate,e.onUpdate,e)}removeTimingListener(e){this._emitter.removeListener(Ge.onSetup,e.onSetup),this._emitter.removeListener(Ge.onUpdate,e.onUpdate)}removeAllTimingListener(){this._emitter.removeAllListeners(Ge.onSetup),this._emitter.removeAllListeners(Ge.onUpdate)}_initializeAndStartPipeline(){let e=this._generatePipelineOptions();return e&&this._onPipelineStart(e.pipelineID),e}_checkAndBindTimingFlag(e,t){if(!e)return;let n="__lynx_timing_flag";t[n]&&(this._bindPipelineIdWithTimingFlag(e.pipelineID,t[n]),this._markTiming(e.pipelineID,"update_set_state_trigger"),e.needTimestamps=!0)}};var cn=Xe;var pn=y.LynxJSBI;var Se=class r{static create(e){return new r(e)}constructor(e){this._cachedFunctions={};for(let t in e)Object.defineProperty(this,t,{get(){if(this._cachedFunctions[t])return this._cachedFunctions[t];let n=e[t];return typeof n=="function"&&(this._cachedFunctions[t]=n),n}})}};function er(r,e,t,n=void 0,o=!1){let{getPromise:i}=y;return typeof i=="function"?i({nextTick:o?n:a=>r(a,0),setTimeout:r,onUnhandled:e,clearTimeout:t}):y.Promise}var Ze=class{constructor(){}decode(e){return e.byteLength===0?"":(e instanceof DataView?e=e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength):ArrayBuffer.isView(e)&&(e=e.buffer),globalThis.TextCodecHelper.decode(e))}encodeInto(){throw TypeError("TextEncoder().encodeInto not supported")}get encoding(){return"utf-8"}get fatal(){return!1}get ignoreBOM(){return!0}};var Dt=class{constructor(){}encode(e){return new Uint8Array(globalThis.TextCodecHelper.encode(e))}encodeInto(){throw TypeError("TextEncoder().encodeInto not supported")}get encoding(){return"utf-8"}};var et=class{};function dn(r){return class extends et{constructor(){super(),this.__dataReceived=[],this.__done=!1,this.__cancelled=!1,this.__locked=!1,this.__eventCenter=new _e}onData(t){this.__cancelled||(this.__dataReceived.push(t),this.__eventCenter.emit("waitSignal",null))}onEnd(){this.__done=!0,this.__eventCenter.emit("waitSignal",null)}onError(t){this.__error=new Error(t),this.__eventCenter.emit("waitSignal",null)}processRead(t,n){if(this.__error)return n(this.__error);if(this.__cancelled||this.__done&&this.__dataReceived.length==0)return t({done:!0,value:void 0});if(this.__dataReceived.length>0){let i=this.__dataReceived.shift();return t({done:!1,value:i})}let o=()=>{this.__eventCenter.removeListener("waitSignal",o),this.processRead(t,n)};this.__eventCenter.addListener("waitSignal",o,this)}__read(){return new r((t,n)=>{this.processRead(t,n)})}get locked(){return this.__locked}cancel(t){return this.__cancelled=!0,this.__dataReceived=null,this.__eventCenter.emit("waitSignal",null),r.resolve(t)}getReader(){return this.__locked?null:(this.__locked=!0,new ln(this))}}}var ln=class{constructor(e){this.__stream=e}cancel(e){return this.__stream.cancel(e)}read(){return this.__stream.__read()}};var Ve=class r{constructor(){this._arrayBuffer=new ArrayBuffer(0),this._bodyStream=null,this._bodyUsed=!1}safeUseBody(e){if(this._bodyUsed)return;let t=e(this._arrayBuffer);return this._bodyUsed=!0,this._arrayBuffer=null,t}cloneArrayBuffer(e){return e.slice(0)}setBody(e){if(e instanceof r){if(e._bodyUsed||e._bodyStream)throw new Error("body used, or try to copy body stream");this._arrayBuffer=this.cloneArrayBuffer(e._arrayBuffer)}else e instanceof ArrayBuffer?this._arrayBuffer=this.cloneArrayBuffer(e):e instanceof DataView?this._arrayBuffer=this.cloneArrayBuffer(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)):ArrayBuffer.isView(e)?this._arrayBuffer=this.cloneArrayBuffer(e.buffer):e&&(this._arrayBuffer=new Dt().encode(e.toString()).buffer),e instanceof et&&(this._bodyStream=e)}arrayBuffer(){return Promise.resolve(this.safeUseBody(e=>e))}get body(){if(this._bodyUsed)throw new Error("body used");return this._bodyUsed=!0,this._bodyStream}text(){return Promise.resolve(this.safeUseBody(e=>new Ze().decode(e)))}json(){return Promise.resolve(this.safeUseBody(e=>JSON.parse(new Ze().decode(e))))}get bodyUsed(){return this._bodyUsed}};var tr;var Oe=class r{constructor(e){if(this._headers_map=new Map,this[tr]="Headers",e===null||typeof e=="number")throw new TypeError("Headers init with null/number");if(e instanceof r)for(let[t,n]of e)this.append(t,n);else Array.isArray(e)?e.forEach(([t,n])=>{this.append(t,Array.isArray(n)?n.join(" "):n)}):e&&Object.getOwnPropertyNames(e).forEach(t=>{let n=e[t];this.append(t,Array.isArray(n)?n.join(" "):n)})}[(tr=Symbol.toStringTag,Symbol.iterator)](){return this.entries()}*keys(){for(let[e,t]of this._headers_map)yield e}*values(){for(let[e,t]of this._headers_map)yield t}*entries(){for(let e of this._headers_map)yield e}has(e){return this._headers_map.has(e)}get(e){var t;return(t=this._headers_map.get(e))!=null?t:null}set(e,t){this._headers_map.set(e,String(t))}append(e,t){let n=this.has(e)?`${this.get(e)}, ${t}`:t;this.set(e,n)}delete(e){this.has(e)&&this._headers_map.delete(e)}forEach(e,t){for(let[n,o]of this.entries())e.call(t,o,n,this)}};var De=class r extends _e{get aborted(){return this._aborted}get reason(){return this._reason}constructor(){super(),this._aborted=!1}get[Symbol.toStringTag](){return"[object AbortSignal]"}dispatchEvent(e){e.type==="abort"&&(this._aborted=!0,this._reason=e.reason,typeof this.onabort=="function"&&this.onabort.call(this,e)),super.emit(e.type,e)}addEventListener(e,t){super.addListener(e,t)}removeEventListener(e,t){super.removeListener(e,t)}static __create(){return new r}},Nt=class{get signal(){return this._signal}constructor(){this._signal=De.__create()}abort(e){let t=e;t===void 0&&(t=new Error("This operation was aborted"),t.name="AbortError");let n={type:"abort",reason:t};this.signal.dispatchEvent(n)}get[Symbol.toStringTag](){return"[object AbortController]"}};var Pt=class r extends Ve{get url(){return this._url}get headers(){return this._headers}get method(){return this._method}get signal(){return this._signal}get lynxExtension(){return this._lynxExtension}constructor(e,t){if(super(),t=t||{},e instanceof r){if(e.bodyUsed)throw new TypeError("Already read");this._url=e.url,t.headers||(this._headers=new Oe(e.headers)),this._method=e.method,this._signal=e.signal,this.setBody(e._arrayBuffer)}else this._url=String(e);if((t.headers||!this.headers)&&(this._headers=new Oe(t.headers)),this._method=t.method||this.method||"GET",this._method=this._method.toUpperCase(),(this.method==="GET"||this.method==="HEAD")&&t.body)throw new TypeError("Body not allowed for GET or HEAD requests");typeof t.signal!="undefined"&&(this._signal=t.signal),this._signal=this._signal||De.__create(),this._lynxExtension=t.lynxExtension||{},this._headers.get("Content-Type")||(typeof t.body=="string"?this._headers.set("Content-Type","text/plain;charset=UTF-8"):globalThis.URLSearchParams&&t.body instanceof URLSearchParams?this._headers.set("Content-Type","application/x-www-form-urlencoded;charset=UTF-8"):t.body instanceof ArrayBuffer||this._headers.set("Content-Type","text/plain;charset=UTF-8")),this.setBody(t.body)}clone(){let e=new r(this,{method:this.method});return e.setBody(this),e}};var Lt=class r extends Ve{get url(){return this._url}get status(){return this._status}get statusText(){return this._statusText}get ok(){return this._ok}get headers(){return this._headers}get lynxExtension(){return this._lynxExtension}constructor(e,t){if(super(),t=t||{},this._status=t.status===void 0?200:t.status,this._status<200||this._status>599)throw new RangeError("Failed to construct 'Response': The status provided (0) is outside the range [200, 599].");this._ok=this._status>=200&&this._status<300,this._statusText=t.statusText===void 0?"":""+t.statusText,this._headers=new Headers(t.headers),this._url=t.url||"",this._lynxExtension=t.lynxExtension||{},this.setBody(e)}clone(){let e=new r(null,{status:this._status,statusText:this._statusText,headers:new Headers(this._headers),url:this._url});return e.setBody(this),e}};function nr(r){return/^(?:(?:(?:https?|ftp):)?\/\/)(?:(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z0-9\u00a1-\uffff][a-z0-9\u00a1-\uffff_-]{0,62})?[a-z0-9\u00a1-\uffff]\.)*(?:[a-z\u00a1-\uffff]{2,}\.?))(?::\d{2,5})?(?:[/?#]\S*)?$/.test(r)}var Mt=class{constructor(e,t){this._searchParamsInstance=null;let n=null;if(!t||nr(e))this._url=e,this._url.endsWith("/")||(this._url+="/");else{if(typeof t=="string"){if(n=t,!nr(n))throw new TypeError(`Invalid base URL: ${n}`)}else n=t.toString();n.endsWith("/")&&(n=n.slice(0,n.length-1)),e.startsWith("/")||(e=`/${e}`),n.endsWith(e)&&(e=""),this._url=`${n}${e}`}}get href(){return this.toString()}get searchParams(){return this._searchParamsInstance==null&&(this._searchParamsInstance=new URLSearchParams),this._searchParamsInstance}toJSON(){return this.toString()}toString(){if(this._searchParamsInstance===null)return this._url;let e=this._searchParamsInstance.toString(),t=this._url.indexOf("?")>-1?"&":"?";return this._url+t+e}};function rr(r){"use strict";var d;let e="__URLSearchParams__";function t(p){p=p||"",p instanceof URLSearchParams&&(p=p.toString()),this[e]=a(p)}let n=t.prototype;n.append=function(p,u){c(this[e],p,u)},n.delete=function(p){delete this[e][p]},n.get=function(p){var u=this[e];return this.has(p)?u[p][0]:null},n.getAll=function(p){var u=this[e];return this.has(p)?u[p].slice(0):[]},n.has=function(p){return h(this[e],p)},n.set=function(u,_){this[e][u]=[""+_]},n.toString=function(){var p=this[e],u=[],_,f,v,x;for(f in p)for(v=o(f),_=0,x=p[f];_<x.length;_++)u.push(v+"="+o(x[_]));return u.join("&")},n.polyfill=!0,n[Symbol.toStringTag]="URLSearchParams",n.forEach=function(p,u){var _=a(this.toString());Object.getOwnPropertyNames(_).forEach(function(f){_[f].forEach(function(v){p.call(u,v,f,this)},this)},this)},n.sort=function(){var p=a(this.toString()),u=[],_,f,v;for(_ in p)u.push(_);for(u.sort(),f=0;f<u.length;f++)this.delete(u[f]);for(f=0;f<u.length;f++){var x=u[f],T=p[x];for(v=0;v<T.length;v++)this.append(x,T[v])}},n.keys=function(){var p=[];return this.forEach(function(u,_){p.push(_)}),s(p)},n.values=function(){var p=[];return this.forEach(function(u){p.push(u)}),s(p)},n.entries=function(){var p=[];return this.forEach(function(u,_){p.push([_,u])}),s(p)},n[Symbol.iterator]=n.entries,Object.defineProperty(n,"size",{get:function(){var p=a(this.toString());if(n===this)throw new TypeError("Illegal invocation at URLSearchParams.invokeGetter");return Object.keys(p).reduce(function(u,_){return u+p[_].length},0)}});function o(p){var u={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(p).replace(/[!'\(\)~]|%20|%00/g,function(_){return u[_]})}function i(p){return p.replace(/[ +]/g,"%20").replace(/(%[a-f0-9]{2})+/ig,function(u){return decodeURIComponent(u)})}function s(p){var u={next:function(){var _=p.shift();return{done:_===void 0,value:_}}};return u[Symbol.iterator]=function(){return u},u}function a(p){var u={};if(typeof p=="object")if(l(p))for(var _=0;_<p.length;_++){var f=p[_];if(l(f)&&f.length===2)c(u,f[0],f[1]);else throw new TypeError("Failed to construct 'URLSearchParams': Sequence initializer must only contain pair elements")}else for(var v in p)p.hasOwnProperty(v)&&c(u,v,p[v]);else{p.indexOf("?")===0&&(p=p.slice(1));for(var x=p.split("&"),T=0;T<x.length;T++){var C=x[T],I=C.indexOf("=");-1<I?c(u,i(C.slice(0,I)),i(C.slice(I+1))):C&&c(u,i(C),"")}}return u}function c(p,u,_){var f=typeof _=="string"?_:_!=null&&typeof _.toString=="function"?_.toString():JSON.stringify(_);h(p,u)?p[u].push(f):p[u]=[f]}function l(p){return!!p&&Object.prototype.toString.call(p)==="[object Array]"}function h(p,u){return Object.prototype.hasOwnProperty.call(p,u)}r.URLSearchParams=(d=r.URLSearchParams)!=null?d:t}function or(r){return class{constructor(t,n={}){this.listeners={},this.url=t,this.options=n,this._closed=!1,this._connect()}close(){this._closed=!0}_dispatchEvent(t,n){let o={type:t,detail:n,timestamp:Date.now(),target:{},currentTarget:{},preventDefault:()=>{},stopPropagation:()=>{}};t==="message"&&this.onmessage?this.onmessage(n):t==="error"&&this.onerror?this.onerror(o):t==="open"&&this.onopen&&this.onopen(o),(this.listeners[t]||[]).forEach(s=>s(n))}addEventListener(t,n){this.listeners[t]=this.listeners[t]||[],this.listeners[t].push(n)}removeEventListener(t,n){this.listeners[t]=this.listeners[t]||[],this.listeners[t]=this.listeners[t].filter(o=>o!==n)}_connect(){return Nn(this,null,function*(){try{let t=yield r(this.url,Ue(N({},this.options),{lynxExtension:{useStreaming:!0}}));this._dispatchEvent("open",{data:""});let n=t.body.getReader();for(;;){let{done:o,value:i}=yield n.read();if(o)break;let s=globalThis.TextCodecHelper.decode(i),a=this._parseEvent(s);a&&this._dispatchEvent(a.event||"message",a)}}catch(t){this._dispatchEvent("error",{data:"",error:t})}})}_parseEvent(t){let n=t.split(`
`),o={data:""};for(let i of n)i.startsWith("data:")?o.data+=i.slice(5).trim()+`
`:i.startsWith("event:")?o.event=i.slice(6).trim():i.startsWith("id:")&&(o.id=i.slice(3).trim());return o.data&&(o.data=o.data.slice(0,-1)),o.data?o:null}}}var nt=class{};nt.EXECUTE_LOADED_SCRIPT="executeLoadedScript";var k=class _BaseApp{constructor(r,e){this.dataTypeSet=new Set(["string","number","array","object","boolean","null","function"]),this.removeInternalEventListenersCallbacks=[],this.setSourceMapRelease=t=>{this.Reporter.setSourceMapRelease(t)},this.getSourceMapRelease=t=>this.Reporter.getSourceMapRelease(t),this.queueMicrotask=t=>{var n,o;if(t)if(!((o=(n=this.params)==null?void 0:n.pageConfigSubset)!=null&&o.enableJSCallbackManager))this.lynx.getNativeLynx().queueMicrotask(t);else{let i=this._callbackManager.addCallback(t);if(i===void 0)return;this.lynx.getNativeLynx().queueMicrotask(i)}},this.wrapClearTimerMethod=t=>{var n,o;return(o=(n=this.params)==null?void 0:n.pageConfigSubset)!=null&&o.enableJSCallbackManager?i=>{t.call(void 0,i),this._callbackManager.removeCallbackByTaskId(i)}:t},this.setupGetTextInfoApi=()=>{this._apiList.getTextInfo=(t,n)=>this._textInfoManager.getTextInfo(t,n)},this.setupExposureApi=()=>{this._apiList.resumeExposure=()=>{this._exposureManager.resumeExposure()},this._apiList.stopExposure=t=>{this._exposureManager.stopExposure(t||{sendEvent:!0})},this._apiList.setObserverFrameRate=t=>{this._exposureManager.setObserverFrameRate(t||{forPageRect:20,forExposureCheck:20})}},this.requestAnimationFrame=t=>this._nativeApp.requestAnimationFrame(t),this.cancelAnimationFrame=t=>this._nativeApp.cancelAnimationFrame(t),this.__removeInternalEventListeners=()=>{this.removeInternalEventListenersCallbacks.forEach(t=>{t()})},this.initBase(r),e?e.transferSingletonData(this,this.__internal__callLynxSetModule.bind(this)):this.initExtra(r),this.addInternalEventListeners(),y["notifyRuntimeReadyOnRT"+this.nativeAppId]&&y["notifyRuntimeReadyOnRT"+this.nativeAppId](this.lynx)}initExtra(r){let{lynx:e}=r;this._callbackManager=new St,this.setTimeout=this.wrapCallbackMethod(this.nativeApp.setTimeout),this.setInterval=this.wrapCallbackMethod(this.nativeApp.setInterval,!1),this.clearInterval=this.wrapClearTimerMethod(this.nativeApp.clearInterval),this.clearTimeout=this.wrapClearTimerMethod(this.nativeApp.clearTimeout),this.modules={},this._lazyCallableModules=new Map,this._nativeApp=Se.create(this._nativeApp),this.sharedConsole=mt(`runtimeId:${this.nativeAppId}`),this.dynamicComponentExports={},this.loadedDynamicComponentsSet=new Set,this._lazyCallableModules=new Map,this.Reporter=new ze(()=>this,()=>this.nativeApp),this.GlobalEventEmitter=new _e(this.__internal__callLynxSetModule.bind(this)),this._intersectionObserverManager=new It(this.NativeModules),this._exposureManager=new Tt(this.NativeModules),this.setupExposureApi(),this._aopManager=new Rt,this.beforePublishEvent=this._aopManager._beforePublishEvent,this.performance=new cn(this.GlobalEventEmitter,this.nativeApp);let t=this.setupPromise(this.setTimeout,this.clearTimeout,this.queueMicrotask);this.lynx=this.createLynx(e,t),this.setupJSModule(),this.setupIntersectionApi(),this.setupFetchAPI(t)}initBase(r){let{nativeApp:e,params:t}=r;this.nativeAppId=e.id,this._params=t,this._nativeApp=e,this.NativeModules=e.nativeModuleProxy,this.LynxUIMethodModule=e.nativeModuleProxy.LynxUIMethodModule,this.LynxTestModule=e.nativeModuleProxy.LynxTestModule,this.LynxResourceModule=e.nativeModuleProxy.LynxResourceModule,this.LynxAccessibilityModule=e.nativeModuleProxy.LynxAccessibilityModule,this.LynxSetModule=e.nativeModuleProxy.LynxSetModule,this._apiList={},this._textInfoManager=new At(this.NativeModules),this.setupGetTextInfoApi()}set __sourcemap__release__(r){let e=new Error;e.name="LynxGetSourceMapReleaseError",e.message=r,e.stack=`at <anonymous> (${_BaseApp.kDefaultSourceMapURL}:1:1)`,this.setSourceMapRelease(e)}wrapCallbackMethod(r,e=!0){var n,o;if(!((o=(n=this.params)==null?void 0:n.pageConfigSubset)!=null&&o.enableJSCallbackManager))return r;let t=this;return function(i,s){if(!i)return-1;let a={taskId:void 0},c=()=>{try{i.apply(i,void 0)}finally{e&&t._callbackManager.removeTaskId(a.taskId)}},l=t._callbackManager.addCallback(c);if(l===void 0)return-1;let h=r.call(void 0,l,s);return h!==void 0&&(t._callbackManager.addTaskIdAndCallbackId(h,l),a.taskId=h),h}}destroy(){this.__removeInternalEventListeners(),this._callbackManager.destroy(),this._nativeApp=null,this._params=null,this._lazyCallableModules=null,this.GlobalEventEmitter=null}registerModule(r,e){this._lazyCallableModules[r]=e}getJSModule(r){return this._lazyCallableModules[r]}setupJSModule(){this.registerModule("GlobalEventEmitter",this.GlobalEventEmitter),this.registerModule("Reporter",this.Reporter)}setupFetchAPI(r){this._createReadableStreamClass=dn,this._ReadableStreamClass=dn(r),y.Request||(y.Request=Pt),y.Response||(y.Response=Lt),y.ReadableStream||(y.ReadableStream=this._ReadableStreamClass)}__internal__callLynxSetModule(r,e){let t=this.LynxSetModule[r];t&&Function.prototype.apply.call(t,void 0,e)}get nativeApp(){return this._nativeApp}set nativeApp(r){this._nativeApp=r}get params(){return this._params}set apiList(r){this._apiList=N(N({},this._apiList),r)}setupIntersectionApi(){let r=this;this._apiList.createIntersectionObserver=function(e,t){let{componentId:n=""}=e;return r._intersectionObserverManager.createIntersectionObserver(n,t)},this.lynx.createIntersectionObserver=this._apiList.createIntersectionObserver}onIntersectionObserverEvent(r,e,t){let n=this._intersectionObserverManager.getObserver(r);n&&n.invokeCallback(e,t)}reportError(r){return this.lynx.reportError(r)}handleError(r,e,t){ie(r,this.nativeApp,{originError:e,getSourceMapRelease:this.getSourceMapRelease,errorLevel:t})}handleUserError(r,e,t,n){let{message:o,name:i,stack:s}=r||{};o||({message:o,name:i,stack:s}=new Error(JSON.stringify(r)));let a=new le(n?`${n} ${i}: ${o}`:`${i}: ${o}`,s);a.cause=e,this.handleError(a,r,t)}handleInternalError(r,e){let{message:t,name:n,stack:o}=r||{};t||({message:t,name:n,stack:o}=new Error(JSON.stringify(r)));let i=new xe(`${n}: ${t}`,o);i.cause=e,this.handleError(i,r)}getBoolEnv(r){let e=this.nativeApp.getEnv(r);return(e==null?void 0:e.toLowerCase())==="true"}_$executeInit(r,{path:e,entryName:t,shouldCacheFactory:n=!0,cacheKey:o}){let i;if(r&&r.init)i=r.init.bind(r);else if(y.initBundle)i=y.initBundle.bind(y.initBundle),delete y.initBundle;else throw new le(`load failed. path:${e},entryName:${t}`);try{this.lynx.performance.profileStart(nt.EXECUTE_LOADED_SCRIPT,{args:{path:e}});let s=i({tt:this});return n&&(_BaseApp._$factoryCache[e]=i),sr(o,r),s}finally{this.lynx.performance.profileEnd()}}_$executeJSON(r,{path:e}){let t=JSON.parse(r),n=()=>t;return _BaseApp._$factoryCache[e]=n,t}requireModule(r,e,t){let n=_BaseApp._$factoryCache[r];if(n)return this._$executeInit({init:n},{path:r,entryName:e});if(r.split("?")[0].endsWith(".json")){let s=this.nativeApp.readScript(r,N({dynamicComponentEntry:e!=null?e:X},t));return this._$executeJSON(s,{path:r,entryName:e})}let o=this.getLoadScriptCacheKey(r,e,this.params.srcName),i=hn(o);if(i)return this._$executeInit(i,{path:r,entryName:e});{let s=this.nativeApp.loadScript(r,e,t);return this._$executeInit(s,{path:r,entryName:e,cacheKey:o})}}requireModuleAsync(r,e){let t=_BaseApp._$factoryCache[r];if(t){e(null,this._$executeInit({init:t},{path:r}));return}if(r.split("?")[0].endsWith(".json")){try{let s=this.nativeApp.readScript(r),a=this._$executeJSON(s,{path:r});e(null,a)}catch(s){e(s)}return}let n=this.getLoadScriptCacheKey(r,this.params.srcName),o=hn(n);if(o)try{return e(null,this._$executeInit(o,{path:r}))}catch(s){e(s)}let i=new Error;this.nativeApp.loadScriptAsync(r,(s,a)=>{if(s)return i.message=s,e(i);try{return e(null,this._$executeInit(a,{path:r,cacheKey:n}))}catch(c){return e(c)}})}require(path,params){let that=this;if(typeof path!="string")throw new Error("require args must be a string");let entryName=params&&params.dynamicComponentEntry?params.dynamicComponentEntry:X;that.modules[entryName]||(that.modules[entryName]={});let module=that.modules[entryName][path];if(!module){try{let tt=that,jsContent=that._nativeApp.readScript(path,{dynamicComponentEntry:entryName});eval(jsContent),module=that.modules[entryName][path]}catch(r){this.handleError(new le(`eval user: ${that._nativeApp.id} error: ${r.message}`,r.stack),r)}if(!that.modules[entryName][path])throw new Error(`module ${path} in ${entryName} is not defined in card: ${that._nativeApp.id}`)}if(!module.hasRun){let{factory:r}=module,e={exports:{}},t;if(module.hasRun=!0,module.exports=e.exports,typeof r=="function"){let n=ir.call(that,path),o=that;t=r(n,e,e.exports,that.Card.bind(o),that.setTimeout,that.setInterval,that.clearInterval,that.clearTimeout,that.NativeModules,that._apiList,that.sharedConsole,that.Component.bind(o),params==null?void 0:params.ReactLynx,that.nativeAppId,that.Behavior.bind(o),pn,that.lynx,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,that.lynx.fetch,void 0,void 0,void 0,void 0,void 0,void 0,that.requestAnimationFrame,that.cancelAnimationFrame),module.exports=e.exports||t}}return module.exports}define(r,e,t){t=t||X,this.modules[t]||(this.modules[t]={}),this.modules[t][r]={hasRun:!1,factory:e.bind(this)}}loadScript(r,e){let{bundleName:t=X,useModuleWrapper:n=!1}=e||{},o=this.getLoadScriptCacheKey(r,t,this.params.srcName,!0),i=hn(o);if(!i){let s=this.lynx.getNativeLynx().loadScript(r,e);if(s&&typeof s.init=="function")i=s;else if(n&&s&&typeof s=="function")i=s;else return s}if(n){let s={exports:{}},a=this,l=[ir.call(a,r),s,s.exports,a.setTimeout,a.setInterval,a.clearInterval,a.clearTimeout,a.NativeModules,a.sharedConsole,a.nativeAppId,pn,a.lynx,a.requestAnimationFrame,a.cancelAnimationFrame,a.lynx.fetch];return i.apply(s.exports,l),sr(o,i),s.exports}else return this._$executeInit(i,{path:r,entryName:e==null?void 0:e.bundleName,shouldCacheFactory:!1,cacheKey:o})}callFunction(r,e,t){try{let n=this.getJSModule(r);typeof n[e]=="function"&&n[e].apply(n,t)}catch(n){this.handleUserError(n,{by:`${r}.${e}`})}}onAppError(r,e){this.handleInternalError(e)}saveDynamicComponentExports(r,e){this.dynamicComponentExports[r]=e}getDynamicComponentExports(r){return this.dynamicComponentExports[r]}Component(...r){}Card(...r){}Behavior(...r){}wrapReport(r,e){let t=this;function n(o){return function(...s){try{return o.apply(this,s)}catch(a){t.handleUserError(a,{by:e})}}}return function(i,...s){return Function.prototype.apply.call(r,void 0,[n(i),...s])}}setupPromise(r,e,t){var o,i,s;let n=er(r,(a,c)=>{try{c&&(c.stack||(c=new Error(JSON.stringify(c))),c.name="unhandled rejection",this.handleUserError(c))}catch(l){}},e,t,(s=(i=(o=this._params)==null?void 0:o.pageConfigSubset)==null?void 0:i.enableMicrotaskPromisePolyfill)!=null?s:!1);return this.resolvedPromise=n.resolve(),n}invokeCallback(r,e,...t){this._callbackManager.invokeCallback(r,e,...t)}addInternalEventListener(r,e,t){this.contextProxyTypeToMethod[r]().addEventListener(e,t),this.removeInternalEventListenersCallbacks.push(()=>{this.contextProxyTypeToMethod[r]().removeEventListener(e,t)})}addInternalEventListeners(){this.contextProxyTypeToMethod||(this.contextProxyTypeToMethod={0:()=>this.lynx.getCoreContext(),1:()=>this.lynx.getDevtool(),2:()=>this.lynx.getJSContext(),3:()=>this.lynx.getUIContext(),4:()=>this.lynx.getNative(),5:()=>this.lynx.getEngine()}),this.addInternalEventListener(0,"__OnNativeAppReady",()=>{this.onNativeAppReady()}),this.addInternalEventListener(0,"__NotifyGlobalPropsUpdated",r=>{this.updateGlobalProps(r.data)}),this.addInternalEventListener(0,"__OnLifecycleEvent",r=>{this.OnLifecycleEvent(r.data)}),this.addInternalEventListener(0,"__OnAppFirstScreen",()=>{this.onAppFirstScreen()}),this.addInternalEventListener(0,"__OnDynamicJSSourcePrepared",r=>{y.loadDynamicComponent(this,r.data)}),this.addInternalEventListener(0,"__OnAppEnterForeground",()=>{this.onAppEnterForeground()}),this.addInternalEventListener(0,"__OnAppEnterBackground",()=>{this.onAppEnterBackground()})}getLoadScriptCacheKey(r,e,t,n=!1){var i,s;if(!t||!((s=(i=this.params)==null?void 0:i.pageConfigSubset)!=null&&s.enableReuseLoadScriptExports)&&!n)return;let o=(e||X)+r;return(r.startsWith("/")||r.startsWith("lynx_assets"))&&(o=t+o),o}updateGlobalProps(r){}OnLifecycleEvent(r){}onNativeAppReady(){}onAppFirstScreen(){}onAppEnterBackground(){}onAppEnterForeground(){}};k.kDefaultSourceMapURL="default";k.kGetSourceMapReleaseErrorName=Wn;k._$factoryCache={};k._$loadScriptCache={};function to(r){let e=r.match(/(.*)\/([^/]+)?$/);return e!=null&&e[1]?e[1]:"./"}function ir(r){let e=this,t=to(r);return function(n){let o=[],i=`${t}/${n}`.split("/"),s=i.length;if(typeof n!="string")throw new Error("require args must be a string");for(let c=0;c<s;++c){let l=i[c];if(l!==""&&l!==".")if(l===".."){if(o.length===0)throw new Error(`can't find module ${n} in app: ${e._nativeApp.id}`);o.pop()}else c+1<s&&i[c+1]===".."?c++:o.push(l)}let a=o.join("/");return a.endsWith(".js")||(a+=".js"),e.require(a)}}function hn(r){if(r)return k._$loadScriptCache[r]}function sr(r,e){!r||!e||(k._$loadScriptCache[r]=e)}var ar;ar||(ar={});var B;(function(r){r.created="created",r.attached="attached",r.ready="ready",r.detached="detached",r.moved="moved"})(B||(B={}));var cr;(function(r){r[r.START=0]="START",r[r.PLAY=1]="PLAY",r[r.PAUSE=2]="PAUSE",r[r.CANCEL=3]="CANCEL",r[r.FINISH=4]="FINISH"})(cr||(cr={}));var rt=class r{constructor(e){this.effect=e,this.id="__lynx-inner-js-animation-"+r.count++}cancel(){this.effect.target.cancelAnimate(this)}pause(){this.effect.target.pauseAnimate(this)}play(){this.effect.target.playAnimate(this)}};rt.count=0;var wt=class{constructor(e,t,n){this.target=e,this.keyframes=t,this.options=n}},Ut=class{constructor(e,t){this.keyframes=e,this.options=t}};var kt=class{constructor(e,t,n){this.id=e,this.effect=new Ut(t,n)}};var ot=class{constructor(e,t,n){this._root=e,this._idSelector="#"+t,this._lynx=n,this._element=void 0}ensureElement(){this._element||(this._element=this._lynx.createElement(this._root,this._idSelector))}animate(e,t){this.ensureElement();let n=new rt(new wt(this,e,t));return this._element.animate(0,n.id,e,t),n}playAnimate(e){this._element.animate(1,e.id,void 0,void 0)}pauseAnimate(e){this._element.animate(2,e.id,void 0,void 0)}cancelAnimate(e){this._element.animate(3,e.id,void 0,void 0)}finishAnimate(e){this._element.animate(4,e.id,void 0,void 0)}setProperty(e,t){if(this.ensureElement(),typeof e=="string"&&typeof t=="string")this._element.setProperty({[e]:t});else if(typeof e=="object")this._element.setProperty(e);else throw new Error(`setProperty's param must be string or object. While current type is ${typeof e} and ${typeof t}.`)}};var de=ot;var H=class r{constructor(e,t,n){this._component=e,this._taskQueue=t,this._native_proxy=n,this._fire_immediately=!1,this._root_unique_id=void 0}static fromQuery(e,t){return new r(t!=null?t:e._component,e._taskQueue.slice(),e._native_proxy)}static newEmptyQuery(e,t){return new r(t!=null?t:"",[],e)}commitTask(e){let t=r.fromQuery(this,this._component);if(t._taskQueue.push(e),this._fire_immediately){t.exec();return}return t}in(e){return e.createSelectorQuery(this)}select(e){return new Ne(this,{type:0,identifier:e,component_id:this._component,root_unique_id:this._root_unique_id,first_only:!0})}selectAll(e){return new Ne(this,{type:0,identifier:e,component_id:this._component,root_unique_id:this._root_unique_id,first_only:!1})}selectReactRef(e){if(this._taskQueue.length){let t="selectReactRef() should be called before any other selector query methods";nativeConsole.warn(t);let n=new Error(t);ie(new Ct(t,n.stack),this._native_proxy.nativeApp);return}return this._fire_immediately=!0,new Ne(this,{type:1,identifier:e,component_id:this._component,root_unique_id:this._root_unique_id,first_only:!0})}selectRoot(){return this.select("")}selectUniqueID(e){return new Ne(this,{type:2,identifier:e.toString(),component_id:this._component,root_unique_id:this._root_unique_id,first_only:!0})}exec(){for(let e=0;e<this._taskQueue.length;++e)this._taskQueue[e](this._native_proxy)}setRoot(e){return this._root_unique_id=Number(e),this}},Ne=class{constructor(e,t){this._nodeSelectToken=t,this._selectorQuery=e}invoke(e){let t,n=o=>{var s;let i=a=>{a.code===0?e.success&&e.success(a.data):e.fail&&e.fail(a)};if(!this._nodeSelectToken.first_only){i({code:5,data:"selectAll not supported for invoke method"});return}o.nativeApp.invokeUIMethod(this._nodeSelectToken.type,this._nodeSelectToken.identifier,this._nodeSelectToken.component_id,e.method,(s=e.params)!=null?s:{},i,this._nodeSelectToken.root_unique_id)};return this._selectorQuery.commitTask(n)}path(e){let t=n=>{let o=i=>{e&&e(i.data,i.status)};n.nativeApp.getPathInfo(this._nodeSelectToken.type,this._nodeSelectToken.identifier,this._nodeSelectToken.component_id,this._nodeSelectToken.first_only,o,this._nodeSelectToken.root_unique_id)};return this._selectorQuery.commitTask(t)}fields(e,t){let n=o=>{let i=a=>{if(e.query){let c=l=>{l.query=H.newEmptyQuery(o),l.query.setRoot(l.unique_id.toString()),e.unique_id||delete l.unique_id};if(this._nodeSelectToken.first_only){let l=a.data;l&&c(l)}else for(let l of a.data)c(l)}t&&t(a.data,a.status)},s=[];for(let a in e){if(a=="query"&&e[a]==!0&&!e.unique_id){s.push("unique_id");continue}e[a]&&s.push(a)}o.nativeApp.getFields(this._nodeSelectToken.type,this._nodeSelectToken.identifier,this._nodeSelectToken.component_id,this._nodeSelectToken.first_only,s,i,this._nodeSelectToken.root_unique_id)};return this._selectorQuery.commitTask(n)}animate(e){let t=[];Array.isArray(e)?t=e:t.push(e);let n=o=>{t.forEach(i=>{var s,a;o.nativeApp.animate(this._nodeSelectToken.type,this._nodeSelectToken.identifier,this._nodeSelectToken.component_id,0,i==null?void 0:i.id,(s=i==null?void 0:i.effect)==null?void 0:s.keyframes,(a=i==null?void 0:i.effect)==null?void 0:a.options)})};return this._selectorQuery.commitTask(n)}animationOperate(e,t){let n=[];Array.isArray(t)?n=t:n.push(t);let o=i=>{n.forEach(s=>{i.nativeApp.animate(this._nodeSelectToken.type,this._nodeSelectToken.identifier,this._nodeSelectToken.component_id,e,s,null,null)})};return this._selectorQuery.commitTask(o)}playAnimation(e){return this.animationOperate(1,e)}pauseAnimation(e){return this.animationOperate(2,e)}cancelAnimation(e){return this.animationOperate(3,e)}finishAnimation(e){return this.animationOperate(4,e)}setNativeProps(e){let t=n=>{n.nativeApp.setNativeProps(this._nodeSelectToken.type,this._nodeSelectToken.identifier,this._nodeSelectToken.component_id,this._nodeSelectToken.first_only,e,this._nodeSelectToken.root_unique_id)};return this._selectorQuery.commitTask(t)}};Ne.nodePool={};var Pe=class r{constructor(e,t,n,o){var i,s,a;this.getNativeApp=e,this.getApp=t,this.Promise=n,this.getNativeLynx=o,this.setTimeout=this.getApp().wrapReport(this.getApp().setTimeout,"setTimeout Error"),this.setInterval=this.getApp().wrapReport(this.getApp().setInterval,"setInterval Error"),this.clearInterval=this.getNativeApp().clearInterval,this.clearTimeout=this.getNativeApp().clearTimeout,this.resumeExposure=this.getApp()._apiList.resumeExposure,this.requireModule=(c,l,h)=>{if(this.requireModule.cache[c])return this.requireModule.cache[c];let d=this.getApp().requireModule(c,l,h);return this.requireModule.cache[c]=d,d},this.requireModuleAsync=(c,l)=>{if(l!=null||(l=h=>{h&&this.getApp().handleUserError(h)}),this.requireModuleAsync.cache[c]){l(null,this.requireModuleAsync.cache[c]);return}this.getApp().requireModuleAsync(c,(h,d)=>{h||(this.requireModuleAsync.cache[c]=d),l(h,d)})},this.createElement=(c,l)=>this.getNativeLynx().createElement(c,l),this.getElementById=c=>new de("",c,this),this.reportError=(c,l)=>{let h;if(yt(c))h=c;else{let u;typeof c!="string"?u=JSON.stringify(c):u=c,h=new Error(u)}let{level:d="error"}=l||{},p;switch(d){case"error":p=1;break;case"warning":p=2;break;case"fatal":p=0;break;default:p=1}this.getApp().handleUserError(h,h.cause,p)},this.registerModule=(c,l)=>this.getApp().registerModule(c,l),this.getJSModule=c=>this.getApp().getJSModule(c),this.getTextInfo=this.getApp()._apiList.getTextInfo,this.addFont=(c,l)=>{if(!A(c))throw new Error("The first argument must be object type");if(!z(c["font-family"])||!z(c.src))throw new Error("The font value must have font-family and src");if(!j(l))throw new Error("The second argument must be function type");this.getNativeLynx().addFont(c,l)},this.stopExposure=this.getApp()._apiList.stopExposure,this.setObserverFrameRate=this.getApp()._apiList.setObserverFrameRate,this.performance=this.getApp().performance,this.beforePublishEvent=this.getApp()._aopManager._beforePublishEvent,this.setSessionStorageItem=(c,l)=>{this.dispatchSessionStorageEvent({type:"__SetSessionStorageItem",data:{key:c,value:l}})},this.getSessionStorageItem=(c,l)=>{this.getNativeApp().getSessionStorageItem(c,l)},this.subscribeSessionStorage=(c,l)=>{let h=r.__registerSharedDataCounter++;return this.getNativeApp().subscribeSessionStorage(c,h,l),h},this.unsubscribeSessionStorage=(c,l)=>{this.dispatchSessionStorageEvent({type:"__UnSubscribeSessionStorage",data:{key:c,listenerId:l}})},this.getDevtool=this.getNativeLynx().getDevtool,this.getCoreContext=this.getNativeLynx().getCoreContext,this.getJSContext=this.getNativeLynx().getJSContext,this.getUIContext=this.getNativeLynx().getUIContext,this.getNative=this.getNativeLynx().getNative,this.getEngine=this.getNativeLynx().getEngine,this.getCustomSectionSync=this.getNativeLynx().getCustomSectionSync,this.accessibilityAnnounce=(i=this.getNativeApp().nativeModuleProxy.LynxAccessibilityModule)==null?void 0:i.accessibilityAnnounce,this.requestResourcePrefetch=(s=this.getNativeApp().nativeModuleProxy.LynxResourceModule)==null?void 0:s.requestResourcePrefetch,this.cancelResourcePrefetch=(a=this.getNativeApp().nativeModuleProxy.LynxResourceModule)==null?void 0:a.cancelResourcePrefetch,this.setSharedData=(c,l)=>{y.sharedData[c]=l;let h={};h[c]=l,y.shareDataSubject.notifyDataChange(h)},this.getSharedData=c=>y.sharedData[c],this.registerSharedDataObserver=c=>y.shareDataSubject.registerObserver(c),this.removeSharedDataObserver=c=>y.shareDataSubject.removeObserver(c),this.triggerLepusGlobalEvent=(c,l)=>this.getNativeApp().triggerLepusGlobalEvent(c,l),this.reload=(c,l)=>{this.getNativeLynx().reload(c,l)},this.fetchDynamicComponent=(c,l,h,d)=>this.getNativeLynx().fetchDynamicComponent(c,l,h,d),this.QueryComponent=(c,l)=>{let h=()=>{l({code:0,data:{url:c,sync:!0,error_message:"",mode:"cache"},detail:{schema:c,cache:!1,errMsg:""}})};if(this.getApp().loadedDynamicComponentsSet.has(c)){h();return}let d=p=>{p.__hasReady===!0?(y.loadDynamicComponent(this.getApp(),c),h()):l(p)};this.getNativeLynx().QueryComponent(c,d)},this.loadDynamicComponent=(c,l,h={})=>new this.Promise((d,p)=>{let u=[],_;if(Array.isArray(c)?(u=c,_=l):typeof l=="string"?(u=[c],_=l):(_=c,h=l),this.getApp().loadedDynamicComponentsSet.has(_)){d({code:0,data:{url:_,sync:!1,error_message:"",mode:"normal"},detail:{schema:_,cache:!1,errMsg:""}});return}this.getNativeLynx().fetchDynamicComponent(_,h,f=>{f&&f.code==0?d(f):p(f)},u)}),this.fetch=(c,l)=>new this.Promise((h,d)=>{let p=new y.Request(c,l),u=p.signal;if(u.aborted)return d(u.reason);u.addEventListener("abort",v=>{d(u.reason)});let _={method:p.method,url:p.url,origin:this.getNativeApp().__pageUrl,headers:Object.fromEntries(p.headers.entries()),body:p._arrayBuffer,lynxExtension:p.lynxExtension},f=p.lynxExtension.useStreaming;this.getApp().NativeModules.LynxFetchModule.fetch(_,v=>{if(!u.aborted)try{let x=new(this.getApp())._ReadableStreamClass,T=new y.Response(f?x:v.body,v);if(f){let C=T.lynxExtension.streamingId;this.getApp().GlobalEventEmitter.addListener(C,I=>{let R=I.event;R==="onData"?x.onData(I.data):R==="onEnd"?x.onEnd():R==="onError"&&x.onError(I.error)})}h(T)}catch(x){d(new TypeError(v.statusText))}},v=>{u.aborted||d(new TypeError(v.message))})}),this.EventSource=or(this.fetch),this.createSelectorQuery=c=>H.newEmptyQuery({nativeApp:this.getNativeApp(),lynx:this},c),this.requestAnimationFrame=c=>this.getNativeApp().requestAnimationFrame(c),this.cancelAnimationFrame=c=>this.getNativeApp().cancelAnimationFrame(c),this.loadScript=(c,l)=>{let{bundleName:h=X}=l,d=h+":"+c;if(this.loadScript.cache[d])return this.loadScript.cache[d];let p=this.getApp().loadScript(c,l);return this.loadScript.cache[d]=p,p},this.fetchBundle=this.getNativeLynx().fetchBundle,this.__addReporterCustomInfo=c=>{this.getNativeApp().__addReporterCustomInfo(c)},this.getModuleLoader=()=>y["napiLoaderOnRT"+this.getApp().nativeAppId],this.createAnimation=(c,l,h)=>new kt(c,l,h),this.init(void 0)}rebind(e){this.init(e)}init(e){if(e)this.getApp=e,this.__globalProps=this.getNativeLynx().__globalProps||{},this.__presetData=this.getNativeLynx().__presetData||{};else{let t={};this.requireModule.cache=t,this.requireModuleAsync.cache=t,this.loadScript.cache={},this.__globalProps=this.getNativeLynx().__globalProps||{},this.__presetData=this.getNativeLynx().__presetData||{},this._switches={}}}dispatchSessionStorageEvent(e){var t=this.getCoreContext().dispatchEvent(e);t!=0&&this.getJSContext().dispatchEvent(e)}queueMicrotask(e){this.getApp().queueMicrotask(e)}};Pe.__registerSharedDataCounter=0;var W;(function(r){r[r.CoreContext=0]="CoreContext",r[r.DevTool=1]="DevTool",r[r.JSContext=2]="JSContext",r[r.UIContext=3]="UIContext",r[r.Native=4]="Native",r[r.Engine=5]="Engine"})(W||(W={}));var F;(function(r){r.ON_NATIVE_APP_READY="__OnNativeAppReady",r.NOTIFY_GLOBAL_PROPS_UPDATED="__NotifyGlobalPropsUpdated",r.ON_LIFECYCLE_EVENT="__OnLifecycleEvent",r.ON_REACT_COMPONENT_RENDER="__OnReactComponentRender",r.ON_REACT_CARD_DID_UPDATE="__OnReactCardDidUpdate",r.ON_REACT_COMPONENT_CREATED="__OnReactComponentCreated",r.ON_REACT_CARD_RENDER="__OnReactCardRender",r.ON_REACT_COMPONENT_UNMOUNT="__OnReactComponentUnmount",r.ON_APP_FIRST_SCREEN="__OnAppFirstScreen",r.ON_DYNAMIC_JS_SOURCE_PREPARED="__OnDynamicJSSourcePrepared",r.ON_APP_ENTER_FOREGROUND="__OnAppEnterForeground",r.ON_APP_ENTER_BACKGROUND="__OnAppEnterBackground",r.ON_COMPONENT_ACTIVITY="__OnComponentActivity",r.FORCE_GC_JSI_OBJECT_WRAPPER="__ForceGcJSIObjectWrapper",r.ON_REACT_COMPONENT_DID_UPDATE="__OnReactComponentDidUpdate",r.ON_REACT_COMPONENT_DID_CATCH="__OnReactComponentDidCatch",r.ON_COMPONENT_SELECTOR_CHANGED="__OnComponentSelectorChanged",r.ON_COMPONENT_PROPERTIES_CHANGED="__OnComponentPropertiesChanged",r.ON_COMPONENT_DATA_SET_CHANGED="__OnComponentDataSetChanged",r.EVENT_SET_SESSION_STORAGE="__SetSessionStorageItem",r.EVENT_GET_SESSION_STORAGE="__GetSessionStorageItem",r.EVENT_SUBSCRIBE_SESSION_STORAGE="__SubscribeSessionStorage",r.EVENT_UNSUBSCRIBE_SESSION_STORAGE="__UnSubscribeSessionStorage"})(F||(F={}));var pr;(function(r){r[r.ID_SELECTOR=0]="ID_SELECTOR",r[r.REF_ID=1]="REF_ID",r[r.UNIQUE_ID=2]="UNIQUE_ID"})(pr||(pr={}));var lr;(function(r){r[r.SUCCESS=0]="SUCCESS",r[r.UNKNOWN=1]="UNKNOWN",r[r.NODE_NOT_FOUND=2]="NODE_NOT_FOUND",r[r.METHOD_NOT_FOUND=3]="METHOD_NOT_FOUND",r[r.PARAM_INVALID=4]="PARAM_INVALID",r[r.SELECTOR_NOT_SUPPORTED=5]="SELECTOR_NOT_SUPPORTED",r[r.NO_UI_FOR_NODE=6]="NO_UI_FOR_NODE"})(lr||(lr={}));var se=class r{constructor(e,t,n,o,i){this._selectorName=n,o&&o.length>0?this._ancestorSelectorNames=[...o]:this._ancestorSelectorNames=[],this._rootComponentId=t,this._proxy=e,this._isCallByRefId=i}getNodeRef(e){return new r(this._proxy,this._rootComponentId,e,[...this._ancestorSelectorNames,this._selectorName],this._isCallByRefId)}invoke(e){let t;this._proxy.nativeLynxUIModule.invokeUIMethod(this._rootComponentId,[...this._ancestorSelectorNames,this._selectorName],e.method,Object.assign({_isCallByRefId:this._isCallByRefId},e.params),n=>{n.code===0?e.success&&e.success(n.data):e.fail&&e.fail(n)})}scrollIntoView(e=!0){let t={};if(typeof e=="boolean")e?t={behavior:"auto",block:"start",inline:"nearest"}:t={behavior:"auto",block:"end",inline:"nearest"};else if(typeof e=="object")t=e;else throw new Error("scrollIntoView only support boolean or object");this.invoke({method:"scrollIntoView",params:{scrollIntoViewOptions:t},fail(n){nativeConsole.error("NodeRef.scrollIntoView failed",`ErrorCode: ${n.code}`)}})}};var qe="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",it=new Uint8Array(256);for(let r=0;r<qe.length;r++)it[qe.charCodeAt(r)]=r;function dr(r){var e=new Uint8Array(r),t,n=e.length,o="";for(t=0;t<n;t+=3)o+=qe[e[t]>>2],o+=qe[(e[t]&3)<<4|e[t+1]>>4],o+=qe[(e[t+1]&15)<<2|e[t+2]>>6],o+=qe[e[t+2]&63];return n%3===2?o=o.substring(0,o.length-1)+"=":n%3===1&&(o=o.substring(0,o.length-2)+"=="),o}function hr(r){let e=r.length*.75,t=r.length,n,o=0,i,s,a,c;r[r.length-1]==="="&&(e--,r[r.length-2]==="="&&e--);let l=new ArrayBuffer(e),h=new Uint8Array(l);for(n=0;n<t;n+=4)i=it[r.charCodeAt(n)],s=it[r.charCodeAt(n+1)],a=it[r.charCodeAt(n+2)],c=it[r.charCodeAt(n+3)],h[o++]=i<<2|s>>4,h[o++]=(s&15)<<4|a>>2,h[o++]=(a&3)<<6|c&63;return l}var jt=class{transferSingletonData(e,t){e.nativeApp=this.nativeApp,e.sharedConsole=this.sharedConsole,e.dynamicComponentExports=this.dynamicComponentExports,e.loadedDynamicComponentsSet=this.loadedDynamicComponentsSet,e._intersectionObserverManager=this.intersectionObserverManager,e._exposureManager=this.exposureManager,e._textInfoManager=this.textInfoManager,this.globalEventEmitter.setCallLynxSetModule(t),e.GlobalEventEmitter=this.globalEventEmitter,e._aopManager=this.aopManager,e.performance=this.performance,e.modules=this.modules,e._lazyCallableModules=this.lazyCallableModules,e.lynx=this.lynx,this.lynx.rebind(()=>e),e._apiList=this.apiList,this.Reporter.rebind(()=>e),e.Reporter=this.Reporter,e._callbackManager=this.callbackManager,e.setTimeout=this.setTimeout,e.setInterval=this.setInterval,e.clearInterval=this.clearInterval,e.clearTimeout=this.clearTimeout,e.resolvedPromise=this.resolvedPromise,e._createReadableStreamClass=this._createReadableStreamClass,e._ReadableStreamClass=this._ReadableStreamClass}};function un(r){q(`destroy ${r}`),y.multiApps[r].destroy(),delete y.multiApps[r]}function fn(r){q(`callDestroyLifetimeFun ${r}`),y.multiApps[r].callDestroyLifetimeFun()}function _n(r,e){if(r.loadedDynamicComponentsSet.has(e))return r.getDynamicComponentExports(e);let t=y.globDynamicComponentEntry;y.globDynamicComponentEntry=e;try{delete r.lynx.requireModule.cache[fe],delete k._$factoryCache[fe];let n=r.lynx.requireModule(fe,e);return r.saveDynamicComponentExports(e,n),r.loadedDynamicComponentsSet.add(e),n}catch(n){r.handleUserError(n)}finally{y.globDynamicComponentEntry=t}}function ur(r,e,t){let{message:n,name:o,stack:i}=e||{};n||({message:n,name:o,stack:i}=new Error(JSON.stringify(e)));let s=new xe(`loadCard failed ${o}: ${n}`,i);s.cause=t,ie(s,r,{originError:e,getSourceMapRelease:a=>{if(!r.__GetSourceMapRelease(a))return r.__GetSourceMapRelease(k.kDefaultSourceMapURL)}})}function mn(r,e,...t){let n=y.multiApps[r];n&&typeof n[e]=="function"&&n[e](...t)}var Z=function(){function r(h,d){return d!=null&&h instanceof d}let e;try{e=Map}catch(h){e=function(){}}let t;try{t=Set}catch(h){t=function(){}}let n;try{n=Promise}catch(h){n=function(){}}function o(h,d,p,u,_){typeof d=="object"&&(p=d.depth,u=d.prototype,_=d.includeNonEnumerable,d=d.circular);let f=[],v=[],x=typeof Buffer!="undefined";typeof d=="undefined"&&(d=!0),typeof p=="undefined"&&(p=1/0);function T(C,I){if(C===null)return null;if(I===0)return C;let R,V;if(typeof C!="object")return C;if(r(C,e))R=new e;else if(r(C,t))R=new t;else if(r(C,n))R=new n(function(L,P){C.then(function(w){L(T(w,I-1))},function(w){P(T(w,I-1))})});else if(o.__isArray(C))R=[];else if(o.__isRegExp(C))R=new RegExp(C.source,l(C)),C.lastIndex&&(R.lastIndex=C.lastIndex);else if(o.__isDate(C))R=new Date(C.getTime());else{if(x&&Buffer.isBuffer(C))return Buffer.allocUnsafe?R=Buffer.allocUnsafe(C.length):R=new Buffer(C.length),C.copy(R),R;r(C,Error)?R=Object.create(C):typeof u=="undefined"?(V=Object.getPrototypeOf(C),R=Object.create(V)):(R=Object.create(u),V=u)}if(d){let L=f.indexOf(C);if(L!==-1)return v[L];f.push(C),v.push(R)}r(C,e)&&C.forEach(function(L,P){let w=T(P,I-1),J=T(L,I-1);R.set(w,J)}),r(C,t)&&C.forEach(function(L){let P=T(L,I-1);R.add(P)});for(let L in C){let P;V&&(P=Object.getOwnPropertyDescriptor(V,L)),!(P&&P.set==null)&&(R[L]=T(C[L],I-1))}if(Object.getOwnPropertySymbols){let L=Object.getOwnPropertySymbols(C);for(let P=0;P<L.length;P++){let w=L[P],J=Object.getOwnPropertyDescriptor(C,w);J&&!J.enumerable&&!_||(R[w]=T(C[w],I-1),J.enumerable||Object.defineProperty(R,w,{enumerable:!1}))}}if(_){let L=Object.getOwnPropertyNames(C);for(let P=0;P<L.length;P++){let w=L[P],J=Object.getOwnPropertyDescriptor(C,w);J!=null&&J.enumerable||(R[w]=T(C[w],I-1),Object.defineProperty(R,w,{enumerable:!1}))}}return R}return T(h,p)}o.clonePrototype=function(d){if(d===null)return null;let p=function(){};return p.prototype=d,new p};function i(h){return Object.prototype.toString.call(h)}o.__objToStr=i;function s(h){return typeof h=="object"&&i(h)==="[object Date]"}o.__isDate=s;function a(h){return typeof h=="object"&&i(h)==="[object Array]"}o.__isArray=a;function c(h){return typeof h=="object"&&i(h)==="[object RegExp]"}o.__isRegExp=c;function l(h){let d="";return h.global&&(d+="g"),h.ignoreCase&&(d+="i"),h.multiline&&(d+="m"),d}return o.__getRegExpFlags=l,o}();var ro=1,oo=1,Ft={};function fr(){return String(ro++)}function _r(r){return Ft[r]||(Ft[r]=String(oo++)),Ft[r]}var io=["onLoad","onShow","onHide","onReady","onDestroy","onError","onFirstScreen"],En={},so=function(){};for(let r of io)En[r]=so;var He=["created","attached","ready","moved","detached"],ae="__Card__",mr="__card_config_",$t="theme",We="onThemeChanged";var me="$$shouldComponentUpdate",Re="$$jsStateVersion",pe="$$nativeStateVersion",Bt="$$renderError",Gt="JS_RENDER_ERROR",Er="LEPUS_RENDER_ERROR",yr="0";function ao(r,e){let t=e._reactAppInstance._getComponent(r);for(;t&&typeof t.parentId=="string";){if(t.parentId===yr)return;if(t=e._reactAppInstance._getComponent(t.parentId),t.$hasDerivedErrorFunction)return t}}function co(r){var e,t;return((e=r==null?void 0:r.state)==null?void 0:e[Bt])===Gt||((t=r==null?void 0:r.state)==null?void 0:t[Bt])===Er}function gr(r,e,t){let n={message:r==null?void 0:r.message,stack:r==null?void 0:r.stack,name:Gt},o=ao(e,t);if(o){if(co(o))return;if(o.$hasDerivedErrorFunction){let i=o.$class.getDerivedStateFromError(n);if(A(i)){let s=Ue(N({},i),{[Bt]:Gt});o.setState(s)}}o.$catchError=n,t.$throwError=n}else throw r}function yn(r){if(D(r)!=="string"){let s="path should be string";throw nativeConsole.error("TypeError",s),new oe(s)}let e=!1,t=!1,n=r.length,o=[],i="";for(let s=0,a=0;a<n;a++){let c=r[a];if(c==="\\")a+1<n&&(r[a+1]==="."||r[a+1]==="["||r[a+1]==="]")?(i+=r[a+1],a++):i+="\\";else if(c===".")i&&(o.push(i),i="");else if(c==="["){if(t)throw nativeConsole.error("DataPathError",`Path can not have nested []: ${r}`),new oe(`Path can not has nested []: ${r}`);if(i&&(o.push(i),i=""),o.length===0)throw nativeConsole.error("DataPathError",`Path can not start with []: ${r}`),new oe(`Path can not start with []: ${r}`);t=!0,e=!1}else if(c==="]"){if(!e)throw nativeConsole.error("DataPathError",`Must have number in []: ${r}`),new oe(`Must have number in []: ${r}`);t=!1,o.push(s),s=0,i=""}else if(t){if(c<"0"||c>"9")throw nativeConsole.error("DataPathError",`Only number 0-9 could inside []: ${r}`),new oe(`Only number 0-9 could inside []: ${r}`);e=!0,s=10*s+c.charCodeAt(0)-48}else i+=c}if(t)throw nativeConsole.error("DataPathError",`[] should appear in pair: ${r}`),new oe(`[] should appear in pair: ${r}`);if(i&&o.push(i),o.length===0)throw nativeConsole.error("DataPathError","Path can not be empty"),new oe("Path can not be empty");return o}function vr(r,e){let t={},n;for(var o=yn(e),i=r,s=0;s<o.length;s++){let a=D(i);if(+(o[s]===o[s]&&o[s]%1===0)){if(a!=="array"&&a!=="object")throw nativeConsole.error(`DataPathError, Expected Array or Object but get ${a}. key: ${e}`),new oe(`DataPathError, Expected Array but get ${a}. key: ${e}`)}else if(a!=="object")throw nativeConsole.error(`DataPathError, Expected Object but get ${a}. key: ${e}`),new oe(`DataPathError, Expected Object but get ${a}. key: ${e}`);n=o[s],t=i,i=i[o[s]]}return{obj:t,key:n}}var Ee=class r{constructor(e){this._queue=[];this.componentId="";this.getSourceMapRelease=e=>this.getApp().getSourceMapRelease(e);let{type:t,componentId:n="",resolvedPromise:o,app:i}=e!=null?e:{};this.getApp=()=>i,this._type=t,this.componentId=n,this.resolvedPromise=o,this._$pendingUpdate=null,this._microTaskPending=!1}get __sourcemap__release__(){return this.getApp().getSourceMapRelease(k.kDefaultSourceMapURL)}nextTick(e){this.resolvedPromise.then(e)}updateData(e,t=this.data,n=!1){for(let o in e){let{obj:i,key:s}=vr(t,o);i&&(i[s]=n?e[o]:Z(e[o]))}}static mergePendingUpdate(e){if(ge(e)){let t=[];e.map(({callback:s})=>{j(s)&&t.push(s)});let n,[o,i]=e.reduce(([s,a],{state:c,updateDataType:l})=>{for(let h in c)c.hasOwnProperty(h)&&h!==me&&(a[h]=c[h]);return a[me]!==!0&&(a[me]=c[me]==null),s|=l,[s,a]},[0,{}]);return i&&i[me]===!0&&delete i[me],{data:i,callbacks:t,stackTraces:n,updateDataType:o}}return r.mergePendingUpdate([e])}dataQueueUpdate(e,t,n,o){j(n)&&(n={callback:n}),Ye(o)||(n.enableFixBatchedUpdateOrder=o);let i,{_queue:s}=e,{enableFixBatchedUpdateOrder:a,updateDataType:c,updateToNative:l=e._nativeApp.batchedUpdateData.bind(e._nativeApp),callback:h}=n,d={state:t,updateDataType:c,stackTrace:i,callback:h};Et(this._$pendingUpdate)?this._$pendingUpdate=d:ge(this._$pendingUpdate)?this._$pendingUpdate.push(d):this._$pendingUpdate=[this._$pendingUpdate,d],s.includes(this)||s.push(this),e._microTaskPending||(e._microTaskPending=!0,this.nextTick(()=>{let p,u=[];e._microTaskPending=!1;let _=f=>{if(f._$pendingUpdate===null)return;let{callbacks:v,stackTraces:x,data:T,updateDataType:C}=r.mergePendingUpdate(f._$pendingUpdate);f._$pendingUpdate=null;let I=this.getApp().lynx.performance._initializeAndStartPipeline();this.getApp().lynx.performance._checkAndBindTimingFlag(I,T);let R={type:f._type,componentId:f.componentId,data:T,updateDataType:C,stackTraces:x,pipelineOptions:I};v.length>0&&(R.callback=po.bind(f,v)),u.push(R)};if(a)e._queue=[],s.forEach(_);else for(;p=s.pop();)_(p);l(u)}))}triggerWorkletFunction(e,t,n,o){var i;try{this.getApp()._nativeApp.triggerWorkletFunction((i=this.componentId)!=null?i:"",e,t,n,o)}catch(s){this.getApp().handleInternalError(s)}}};function po(r){if(Array.isArray(r))for(let e=0,t=r.length;e<t;++e)r[e]()}var M=class{};M.REACT_COMPONENT_CREATED="onReactComponentCreated",M.REACT_COMPONENT_RENDER="onReactComponentRender",M.REACT_COMPONENT_DID_UPDATE="onReactComponentDidUpdate",M.REACT_COMPONENT_DID_CATCH="onReactComponentDidCatch",M.REACT_COMPONENT_UNMOUNT="onReactComponentUnmount",M.REACT_COMPONENT_SET_STATE="ReactComponent::setState",M.TT_UPDATE_SIGNAL="updateSignal",M.TT_UPDATE_SIGNALS="updateSignals";var xr=50,vn=10,ho=1e4,gn=class r extends Ee{constructor(t={}){super();this.prevProps={};this.prevState={};this.nextProps={};this.nextState={};this.$init=!1;this.$cardInit=!1;this.$prefix="";this.componentPath="";this.entryName="";this.globalProps=null;this._asyncSetStateMicroTaskPending=!1;this.$jsStateVersion=0;this.$nativeStateVersion=0;this.$componentState=0;this.$isInCtor=!0;this.parentId="";this.$catchError=null;this.$throwError=null;this.$isUpdatingState=!1;this.$nestedUpdateCount=0;this.$startDetectNestedUpdateTimestamp=0;this.$hasNestedUpdate=!1;this.state={},this.props=t,this.prevProps={},this.prevState={},this.$prefix=fr(),this.setComponentConfig(this.constructor),this.$refs=[],this.$pureData={},this._stateQueue=[],this._uiModule=this._nativeApp.nativeModuleProxy.LynxUIMethodModule}static call(t,...n){return Reflect.construct(r,n,Object.getPrototypeOf(t).constructor)}static apply(t,n){return Reflect.construct(r,n,Object.getPrototypeOf(t).constructor)}get _reactAppInstance(){return this.getApp()}get nativeApp(){return this._nativeApp}executeJSRender(){this.clearRef();let t=this._createData();return this.bindRef(),t}handleExceptionInJS(t){gr(t,this.componentId,this)}bindRef(){!this.$refs||this.$refs.length<1||this.$refs.forEach(t=>{this.bindComponent(t)})}bindComponent(t){var i;let n=null;if(t.type==="native"){let s=this.getApp().lynx;((i=s._switches.useSelectorQueryAsReactRef)!=null?i:new Ie(s.targetSdkVersion).gte(Jn))?n=this.createSelectorQuery().selectReactRef(t.refId):n=this.getNodeRef(t.refId,!0)}else t.type==="com"&&z(this.$pureData[t.refId])&&(n=this._reactAppInstance._getComponent(this.$pureData[t.refId]));let o=typeof t.ref;A(n)&&(o==="function"?t.ref.call(this,n):o==="object"&&"current"in t.ref&&(t.ref.current=n,t.ref.id=this.componentId))}bindSingleRef(t){A(t)&&this.bindComponent(t)}clearRef(){Array.isArray(this.$refs)&&this.$refs.length>0&&this.$refs.forEach(t=>{if(typeof t.ref=="function")try{t.ref.call(this,null)}catch(n){}}),this.$refs=[]}clearRefToThis(){if(!this.$componentIdContainsRefToThis)return;let t=this.$componentIdContainsRefToThis.componentId=="card"?this._reactAppInstance.appInstance:this._reactAppInstance._getComponent(this.$componentIdContainsRefToThis.componentId);if(t){if(!t.$refs.includes(this.$componentIdContainsRefToThis.refItem)){this.$componentIdContainsRefToThis=null;return}try{this.$componentIdContainsRefToThis.refItem.ref.call(t,null)}catch(n){}delete t.$pureData[this.$componentIdContainsRefToThis.refItem.refId],this.$componentIdContainsRefToThis=null}}updateTheme(t,n=!1){let o=this;try{let i=D(t);if(i!=="object")throw new Error(`updateTheme's first param must be object, you pass ${i}`);let s={};n?Object.assign(s,t):Object.assign(s,o.theme,t),Object.keys(s).forEach(a=>{s[a]||delete s[a]}),o._nativeApp.updateData({__card_config_:{theme:s}},1),o[$t]=s,typeof o[We]=="function"&&o[We](s)}catch(i){this.getApp().handleUserError(i)}}setStateByPath(t,n,o){typeof t=="string"?t={[t]:n}:typeof n=="function"&&(o=n),this.setState(t,o)}setState(t,n){var s;if(this.getApp().lynx.performance.profileStart(M.REACT_COMPONENT_SET_STATE,{args:{componentPath:this._type==="card"?"card":this.componentPath}}),this._type==="card"&&this.$componentState===2){this.getApp().lynx.performance.profileEnd();return}if(this.$isInCtor){let{initNativeStateVersion:a}=this.$class.__config;nativeConsole.alog(`has setState in Ctor, change $nativeStateVersion from ${this.$nativeStateVersion} to ${a}`),Ye(a)||(this.$nativeStateVersion=a)}if(this.$nestedUpdateCount>xr&&!this.$hasNestedUpdate&&(this.$nestedUpdateCount=0,Date.now()-this.$startDetectNestedUpdateTimestamp<ho*(xr-vn))){this.$hasNestedUpdate=!0,this.$startDetectNestedUpdateTimestamp=0;let a="Maximum update depth exceeded. This can happen when a component repeatedly calls setState inside componentDidUpdate. ReactLynx limits the number of nested updates to prevent infinite loops.";nativeConsole.warn(a);let c=new Error(a);ie(new le(a,c.stack),this._nativeApp,{originError:c,getSourceMapRelease:this.getSourceMapRelease,errorCode:20100,errorLevel:gt.Warn})}this.$isUpdatingState=!0;let o=this,i=null;try{let a=D(t);if(a==="function")i=t(o.state,o.props);else if(a==="object")i=t;else throw new Error(`setState's first param must be object/function, you pass ${a}`);let c=D(n);if(n&&c!=="function")throw new Error(`setState's second param must be function, you pass ${c}`);(s=this._reactAppInstance.lynx._switches)!=null&&s.asyncSetState?this.setStateInternalAsync(i,n):this.setStateInternal(i,n,{updateDataType:1})}catch(a){this.getApp().handleInternalError(a)}finally{this.getApp().lynx.performance.profileEnd()}}setStateInternalAsync(t,n){this._stateQueue.push({state:t,callback:n}),this._asyncSetStateMicroTaskPending||(this._asyncSetStateMicroTaskPending=!0,this._reactAppInstance.resolvedPromise.then(()=>{this._asyncSetStateMicroTaskPending=!1;let o={},i=[];this._stateQueue.forEach(({state:a,callback:c})=>{Object.assign(o,a),i.push(c)}),this._stateQueue=[];let s=()=>{i.forEach(a=>{$("at setState/async",this,a).bind(this)()})};this.setStateInternal(o,s,{updateDataType:1})}))}setStateInternal(t,n,o={}){let i=this;try{this.nextProps=this.props,j(this.shouldComponentUpdate)?this.nextState=Z(this.state):this.nextState=this.state,super.updateData(t,this.nextState,!0);let s=null,a={};i.$hasDerivedFunction&&(s=i.$class.getDerivedStateFromProps(i.nextProps,i.nextState),a=this.getApp().diffData(this.nextState,s),super.updateData(s||{},i.nextState,!0));let c=!0;if(j(this.shouldComponentUpdate)&&(c=i.shouldComponentUpdate(this.nextProps,this.nextState)),this.state=this.nextState,!c){let p=Object.assign({},t,a);Object.keys(p).length&&(p[me]=!1,this.dataQueueUpdate(i,p,{callback:$("at setState/dataQueueUpdate",i,n).bind(i),updateDataType:o.updateDataType}));return}let l=i.executeJSRender();if(i.$throwError)return;let h=this.getApp().diffData(this.state,l);i.state=Object.assign(i.state,l);let d=Object.assign({},t,a,h);Object.keys(d).length&&this.dataQueueUpdate(i,d,{callback:$("at setState/dataQueueUpdate",i,n).bind(i),updateDataType:o.updateDataType})}catch(s){this.getApp().handleUserError(s)}}updateDataToNative(t,n,o=!1){(t&&Object.keys(t).length||o)&&(o&&(n|=8),this.dataQueueUpdate(this,t,{updateDataType:n}))}dataQueueUpdate(t,n,o){var a;let i=(a=this._reactAppInstance.lynx._switches)==null?void 0:a.enableFixBatchedUpdateOrder;t=i?this._reactAppInstance.appInstance||this:this,o.enableFixBatchedUpdateOrder=i,this.$jsStateVersion+=1;let s={[Re]:this.$jsStateVersion,[pe]:this.$nativeStateVersion};Object.assign(n,s),super.dataQueueUpdate(t,n,o)}nextTick(t){var n;if(!((n=this._reactAppInstance.lynx._switches)!=null&&n.enableReactBatchedUpdate)&&(y.SystemInfo||{}).platform==="iOS"){t();return}this._reactAppInstance.resolvedPromise.then(t)}registerModule(t,n){this._reactAppInstance.registerModule(t,n)}get $hasDidUpdateLifecycleV2(){return this.$alwaysCheckLifecycleFunction?this.componentDidUpdate!==r.prototype.componentDidUpdate:this.$hasDidUpdateLifecycle}get $hasDidCatchLifecycleV2(){return this.$alwaysCheckLifecycleFunction?this.componentDidCatch!==r.prototype.componentDidCatch:this.$hasDidCatchLifecycle}setComponentConfig(t){var i,s;this.$class=t,this.$hasDerivedFunction=j(t.getDerivedStateFromProps),this.$alwaysCheckLifecycleFunction=new Ie(((s=(i=this.getApp())==null?void 0:i.lynx)==null?void 0:s.targetSdkVersion)||"1.4").gte(Yn),this.$hasDidUpdateLifecycle=this.componentDidUpdate!==r.prototype.componentDidUpdate,this.$hasDerivedErrorFunction=j(t.getDerivedStateFromError),this.$hasDidCatchLifecycle=this.componentDidCatch!==r.prototype.componentDidCatch;let n=t.__config,o=n.appInstance.lynx;this._type=n.$type,this._nativeApp=n.appInstance.nativeApp,this.getApp=()=>n.appInstance,this.componentId=n.componentId,this.setGlobalProps(o,n.initData),this.GlobalEventEmitter=this._reactAppInstance.GlobalEventEmitter}getJSModule(t){return this._reactAppInstance.getJSModule(t)}getNodeRef(t,n){return new se({nativeLynxUIModule:this._uiModule,nativeApp:this._nativeApp,disableWarningWhenFailed:this._reactAppInstance.lynx._switches.disableNodeRefWarningWhenFailed},this._type==="component"?this.componentId:"",t,[],n)}getNodeRefFromRoot(t){return new se({nativeLynxUIModule:this._uiModule,nativeApp:this._nativeApp,disableWarningWhenFailed:this._reactAppInstance.lynx._switches.disableNodeRefWarningWhenFailed},"",t)}createSelectorQuery(t){return t?H.fromQuery(t,this.componentId):H.newEmptyQuery({nativeApp:this._nativeApp,lynx:this._reactAppInstance.lynx},this.componentId)}getPathFromTarget(t,n){this.createSelectorQuery().selectUniqueID(t.uid).path(n).exec()}getElementById(t){return new de(this.componentId?this.componentId:"card",t,this._reactAppInstance.lynx)}selectComponent(t,n){let o=this,i=D(n);if(n&&i!=="function")throw new Error(`selectComponent's second param must be function, you pass ${i}`);let s=a=>{Array.isArray(a)&&n(this._reactAppInstance.getComponent(a[0]))};this._nativeApp.selectComponent(this.componentId,t,!0,$("at component selectComponent",o,s).bind(o))}addGlobalEventListener(t,n,o){this.getJSModule("GlobalEventEmitter").addListener(t,n,o)}setSharedData(t,n){y.sharedData[t]=n}getSharedData(t){return y.sharedData[t]}setGlobalProps(t,n){t&&!t.__globalProps&&n&&n.__globalProps&&(t.__globalProps=n.__globalProps)}triggerEvent(t,n={},o={}){let i=this;try{let{componentId:s}=i;i._nativeApp.triggerComponentEvent(t,{eventDetail:n,eventOption:o,componentId:s})}catch(s){this.getApp().handleInternalError(s)}}componentDidCatch(t){}componentDidMount(){}componentWillUnmount(){}componentDidUpdate(t,n,o){}componentDidShow(){}componentDidHide(){}},Vt=gn;var xn=class{constructor(){this._map={}}set(e={},t){this._map[t]=e}getProps(e){return this._map[e]}deleteProps(e){delete this._map[e]}clear(){this._map={}}},Cr=xn;function Le(r){return r&&r.$_isFunctionComponent}var qt,Cn,bn,he;function Ht(){return Cn}function br(r,e){return typeof e=="function"?e(r):e}function Sr(r){typeof r._cleanup=="function"&&r._cleanup()}function uo(r){r._cleanup=r._value()}function Rr(r,e){return!r||r.length!==e.length||e.some((t,n)=>t!==r[n])}function Sn(r){let e=Ht(),t=e.__hooks||(e.__hooks={_list:[],_pendingEffects:[]});return r>=t._list.length&&t._list.push({_type:he}),he=0,t._list[r]}function fo(r,e){Cn=r,bn=e||{}}function _o(r){qt=0,Cn=r}function mo(r){let e=r.__hooks;e&&(e._pendingEffects.forEach(Sr),e._pendingEffects.forEach(uo),e._pendingEffects=[])}function Eo(r){if(r&&r.__hooks)try{r.__hooks._list.forEach(Sr)}catch(e){bn.catchError(e)}}function yo(r,e){he=3;let t=Ht(),n=Sn(qt++);!bn._skipEffects&&Rr(n._args,e)&&(n._value=r,n._args=e,t.__hooks._pendingEffects.push(n))}function Ar(r,e,t){he===0&&(he=2);let n=Ht(),o=Sn(qt++);return o._reducer=r,o._component||(o._value=[t?t(e):br(void 0,e),i=>{let s=o._reducer(o._value[0],i);o._value[0]!==s&&(o._value=[s,o._value[1]],o._component.setHookState())}],o._component=n),o._value}function go(r){return he=1,Ar(br,r,null)}function Rn(r,e){he===0&&(he=4);let t=Sn(qt++);return Rr(t._args,e)&&(t._value=r(),t._args=e,t._factory=r),t._value}function vo(r,e){return he=5,Rn(()=>r,e)}function xo(r){return he=6,Rn(()=>({current:r,id:null}),[])}function Co(){return Ht()}function bo(r,e,t=!1){if(!r||!r.$_hookStateKeys||typeof e!="object")return;let n=r.$_hookStateKeys;n.length&&Object.keys(e).filter(o=>n.includes(o)).forEach(o=>{let i=null;if(t&&ve(e[o]))return;let s=n.findIndex(a=>a===o);s!=-1&&(i=(r.__hooks&&r.__hooks._list?r.__hooks._list.filter(c=>c._type===1||c._type===2):[])[s],i&&(i._value[0]=e[o]))})}var G={useState:go,useReducer:Ar,useEffect:yo,useMemo:Rn,useCallback:vo,useRef:xo,mountHooks:fo,cleanUpHooks:Eo,executeEffects:mo,resetHooks:_o,syncInsHookState:bo,useInstance:Co};var An=class extends Vt{executeJSRender(){let e=this;return G.resetHooks(e),e._createData()}setHookState(){this.batching||(this.batching=!0,this._reactAppInstance.resolvedPromise.then(()=>{this.batching=!1,this.setHookStateInternal()}))}setHookStateInternal(){let e=this;try{let t=e.executeJSRender();if(e.$throwError)return;let n=this.getApp().diffData(this.state,t);e.state=Object.assign(e.state,t),Object.keys(n).length&&this.updateDataToNative(n,4)}catch(t){this.getApp().handleInternalError(t)}}},Tr=An;function Ir(r,e){return r===e||r!==r&&e!==e}var Je=(r,e,t)=>{if(r===e)return!0;let n=D(r),o=D(e);if(t||(t=new WeakMap),n===o)if(n==="array"){if(r.length!==e.length)return!1;if(t.has(r)&&t.has(e))return t.get(r)===e;t.set(r,e),t.set(e,r);let i=!0;return r.some((s,a)=>(i=Je(s,e[a],t),!i)),t.delete(r),t.delete(e),i}else if(n==="object"){let i=Object.keys(r);if(i.length!==Object.keys(e).length)return!1;if(t.has(r)&&t.has(e))return t.get(r)===e;t.set(r,e),t.set(e,r);let s=!0;return i.some(a=>(s=Je(r[a],e[a],t),!s)),t.delete(r),t.delete(e),s}else return n==="date"?Ir(+r,+e):n==="regExp"?r.toString()===e.toString():Ir(r,e);return!1},Or=(r,e)=>{let t={};if(A(e)){let n=new Set(r);Object.keys(e).forEach(o=>{n.has(o)||(t[o]=e[o])})}return t};var at=class r{constructor(e,t,n,o){this._url=e,this._name=t,this._workerId=n,this._nativeApp=o}static createWorker(e){return(t,n)=>{let o=e.createWorker(t,n);return new r(t,n,o,e)}}postMessage(e){this._nativeApp.postMessage(this._workerId,e)}onMessage(e){this._nativeApp.onMessage(this._workerId,e)}onException(e){this._nativeApp.onException(this._workerId,e)}onTerminate(e){this._nativeApp.onTerminate(this._workerId,e)}terminate(){this._nativeApp.terminate(this._workerId)}};var Wt=class extends Pe{constructor(t,n,o,i){super(t,n,o,i);this.getNativeApp=t;this.getApp=n;this.Promise=o;this.getNativeLynx=i;this.nativeDataChanged=!1;this.getComponentContext=(t,n,o)=>this.getNativeLynx().getComponentContext(t,n,o);this.getJSModule=t=>this.getApp().getJSModule(t);this.createWorker=at.createWorker(this.getNativeApp());this.getI18nResource=this.getNativeLynx().getI18nResource;this.initSub(void 0)}rebind(t){super.rebind(t),this.initSub(t)}initSub(t){}setupCanvasInJS(){let t=this.getApp().CanvasModule;t&&t.setupCanvas()&&this.getApp().setupCanvasEnv()}};var ce=class extends k{constructor(t,n){let{nativeApp:o,params:i}=t;super(t,n);this.componentEventBatch={};this.$isErrorHandling=!1;this.reserveKey=new Set(["__globalProps","SystemInfo"]);this.dataTypeSet=new Set(["string","number","array","object","boolean","null","function"]);this.diffData=(t,n,o)=>{let i={};if(t===n)return i;if(A(n)){let s=A(t),a=Object.keys(n);a.length&&(o&&o.length?o:a).forEach(l=>{let h=n[l];this.dataTypeSet.has(D(h))&&(s&&Je(t[l],h)||(i[l]=h))})}return i};this.filterReactComponentData=t=>{let n={};return A(t)&&Object.keys(t).forEach(o=>{let i=t[o],s=D(i);this.dataTypeSet.has(s)&&!this.reserveKey.has(o)&&(n[o]=i)}),n};this.hasJSOnlyData=t=>A(t)?Object.keys(t).some(n=>{let o=t[n],i=D(o);return!this.dataTypeSet.has(i)}):!1;this.BDLynxModule=o.nativeModuleProxy.BDLynxModule,this.CanvasModule=o.nativeModuleProxy.CanvasNativeModule,this.CanvasModule&&this.CanvasModule.enableCanvasOptimization()&&this.setupCanvasEnv()}set appInstance(t){this._appInstance=t}get appInstance(){return this._appInstance}destroy(){super.destroy(),this._canvasEngine&&(this._canvasEngine.destroy(),this._canvasEngine=void 0)}setupCanvasEnv(){if(this._canvasEngine)return;let t=y["napiLoaderOnRT"+this.nativeAppId],n=t.load("krypton_environment");if(n){let o=n.setupKryptonEngine();o&&(this._canvasEngine=new o({loader:t,promise:this.lynx.Promise,timerFunctions:{setTimeout:this.setTimeout,clearTimeout:this.clearTimeout,setInterval:this.setInterval,clearInterval:this.clearInterval},featureReporter:i=>{this._nativeApp.featureCount(i)},consoleProxy:nativeConsole}),this._canvasEngine.registerSyncWaitFeature(Be.TypescriptHeliumCreateCanvasWait),this._canvasEngine.append(this.lynx,!1))}}saveComponentEventBatch(t,n,o){this.componentEventBatch[t]||(this.componentEventBatch[t]=[]),this.componentEventBatch[t].push({eventName:n,data:o})}processCardConfig(t){let n=this.appInstance;try{if(typeof t=="string"&&(t=JSON.parse(t)),t&&typeof t=="object"){let o=t[mr];if(A(o)){let{theme:i}=o;A(i)&&(n[$t]=i,typeof n[We]=="function"&&n[We](i))}}}catch(o){this.handleUserError(o)}}onHMRUpdate(t){}updateGlobalProps(t){let n=this;try{if(!n.appInstance)return;Object.keys(t).forEach(i=>{let s=t[i];this.lynx.__globalProps[i]=s}),this.onGlobalPropsChanged(t)}catch(o){this.handleUserError(o)}}onGlobalPropsChanged(t){let n=this.appInstance;typeof n.onGlobalPropsChanged=="function"&&n.onGlobalPropsChanged.call(n,t)}OnLifecycleEvent(t){}forceGcJSIObjectWrapper(){this.lynx.getJSContext().dispatchEvent({type:F.FORCE_GC_JSI_OBJECT_WRAPPER,data:void 0})}createLynx(t,n){let o=Se.create(t);return new Wt(()=>this.nativeApp,()=>this,n,()=>o)}};var ct=class extends ce{constructor(e,t){super(e,t);let{params:n}=e;this._componentMap={},this._dynamicComponentMap={},this._componentInstance={},this._reactLynx={},this.rlynxVersion=n==null?void 0:n.rlynxVersion,this.globalErrorEvents=[],this._propsMap=new Cr,this._reactLynx.propsMap=this._propsMap,this._reactLynx.genPropsId=_r,this._reactLynx.ReactComponent=Vt,this._reactLynx.createRef=()=>({current:null,id:null}),this._getComponent=this.getComponent,this.lynx.onError=o=>this.subscribeGlobalError(o),this.lynx.nativeDataChanged=!1,G.mountHooks(this,{catchError:o=>{this.handleInternalError(o)}}),this._reactLynx.ReactFcComponent=Tr,this._reactLynx.useReducer=G.useReducer,this._reactLynx.useState=G.useState,this._reactLynx.useEffect=G.useEffect,this._reactLynx.useMemo=G.useMemo,this._reactLynx.useCallback=G.useCallback,this._reactLynx.useInstance=G.useInstance,this._reactLynx.useRef=G.useRef,this._reactLynx.createRef=o=>({current:o,id:null})}subscribeGlobalError(e){this.globalErrorEvents.push(e)}publishGlobalError(...e){this.globalErrorEvents&&this.globalErrorEvents.length>0&&this.globalErrorEvents.forEach(t=>{t(...e)})}handleError(e,t,n){super.handleError(e,t,n),!this.$isErrorHandling&&(this.$isErrorHandling=!0,this.publishGlobalError(e,e.message,e.stack),this.dispatchError(e.message||e.stack),this.$isErrorHandling=!1)}Card(e,t){let n=this;this._cardComponentClass=e;try{let{initData:o,updateData:i,initConfig:s}=n._params||{};if(e.__config={$type:"card",appInstance:n,initData:o,componentId:""},n.appInstance=new e(e.defaultProps),n.appInstance.$isInCtor=!1,o&&typeof o=="object"&&n.initCardData(o),i&&typeof i=="object")try{let a=n.appInstance;Object.keys(i).forEach(c=>{a.state[c]=i[c]}),Le(a)&&G.syncInsHookState(a,i),this.lynx.nativeDataChanged=!0}catch(a){this.handleInternalError(a)}s&&typeof s=="object"&&n.processCardConfig(s)}catch(o){this.handleInternalError(o)}}Component(e,t){let{globDynamicComponentEntry:n,globComponentRegistPath:o}=y;n||(n=ae),this._componentMap[n]||(this._componentMap[n]={}),this._componentMap[n][o]=e}initCardData(e){let t=this;try{let n=t.appInstance;Object.keys(e).forEach(o=>{Te(n.state,o)||(n.state[o]=e[o])})}catch(n){this.handleInternalError(n)}}onReactCardRender(e,t,n){let i=this.appInstance;if(!i){q("onReactCardRender execution stopped because card creation failed");return}typeof e=="string"&&(e=JSON.parse(e));let s=this.processVersionsAndCheckForConflict(e,i);if(i.$cardInit){this.lynx.nativeDataChanged=!0;try{e&&typeof e=="object"&&Object.keys(e).forEach(u=>{ve(e[u])||(i.state[u]=e[u]),Le(i)&&G.syncInsHookState(i,e,!0)});let a=0;if(s){this.flushNative(i,32);return}if(!t)return;let c={},l={};i.$hasDerivedFunction&&!i.$shouldIgnoreLepusDataProcessor&&(c=i.$class.getDerivedStateFromProps(i.props||{},i.state)||{},l=this.diffData(i.state,c),i.state=Object.assign(i.state,c));let h=i.executeJSRender()||{},d=this.diffData(i.state,h);i.state=Object.assign(i.state,h);let p=Object.assign(l,d);Object.keys(l).length>0&&(a|=16),Object.keys(d).length>0&&(a|=4),Object.keys(p).length&&i.updateDataToNative(p,a)}catch(a){this.handleInternalError(a)}}else try{i.$cardInit=!0,this.flushNative(i,2,n)}catch(a){this.handleInternalError(a)}}onReactComponentCreated(e,t,n,o,i,s,a){var ut,Me;this.lynx.performance.profileStart(M.REACT_COMPONENT_CREATED,{args:{componentPath:e}}),e.startsWith("/")&&(e=e.substr(1)),(ut=this._supportConstructorUpdateData)!=null||(this._supportConstructorUpdateData=new Ie(this.lynx.targetSdkVersion).gte(Kn));let c=s?this._componentMap[s][e]:this._componentMap[ae][e];if(!c){nativeConsole.warn(`Create component path:${e}, entryName:${s}, is undefined.Find previous errors or red screens to resolve the issue.`),this.lynx.performance.profileEnd();return}c.defaultProps=c.defaultProps||{};let l=(n?this._propsMap.getProps(n.propsId):null)||{},h=Object.keys(c.defaultProps),d=Object.keys(l),p=[...h];d.forEach(O=>{p.includes(O)||p.push(O)});let u={};Object.keys(c.defaultProps).filter(O=>{d.includes(O)&&l[O]===null?u[O]=null:u[O]=c.defaultProps[O]});let _=Fe(n,l);_=Fe(u,_,!0),c.__config={$type:"component",appInstance:this,__sourcemap__release__:this.__sourcemap__release__,componentId:t,initNativeStateVersion:o[pe]};let f=new c(_);f.$isInCtor=!1,o&&typeof o=="object"&&pe in o&&(f.$nativeStateVersion=o[pe]),f.componentPath=e,f.entryName=s,this.setComponent(t,f,i);let v=0,x=[];Object.keys(f.state).forEach(O=>{(!Te(o,O)||(o[O]===null||o[O]===void 0)&&f.state[O]!==null&&f.state[O]!==void 0)&&x.push(O)}),x.length>0&&(v|=2);let T=!1;if(n.$$onlyPropsId)T=this.hasJSOnlyData(l);else{let O=Object.keys(n);T=p.filter(ee=>!O.includes(ee)||n[ee]===null).length>0}let C=this._supportConstructorUpdateData&&!f.$shouldIgnoreStateCheckInConstructor,I=null,R=null;if(f.$hasDerivedFunction&&(T||x.length||!f.$shouldIgnoreLepusDataProcessor||C)){if(I=f.$class.getDerivedStateFromProps(f.props,f.state),f.state=Object.assign(f.state,I||{}),C){(Me=this._shouldReportErrorForCompatible)!=null||(this._shouldReportErrorForCompatible=new Ie(this.lynx.targetSdkVersion).lte(Qn));let O=Object.keys(I||{});if(this._shouldReportErrorForCompatible&&I==null){let we="lifeCycle getDerivedStateFromProps of component: ${componentInstance.componentPath} returned null or undefined. When 2.9 <= targetSdkVersion <= 2.12, you need to ensure that it does not return null or undefined, or upgrade @byted-lynx/lynx-speedy to ^2.47.1.",E=new Error(we);this.handleUserError(E)}let ee=this.diffData(f.state,o,Object.keys(o).filter(we=>!O.includes(we)));delete ee[pe],delete ee[Re],R=Object.keys(ee||{})}}else if(C){let O=this.diffData(f.state,o);delete O[pe],delete O[Re],R=Object.keys(O||{})}else f.$hasDerivedFunction&&(f.state=Fe(f.state,o,!0));let V=f.executeJSRender()||{};if(f.$throwError){this.lynx.performance.profileEnd();return}f.state=Object.assign(f.state,V),Object.keys(V).length>0&&(v|=4);let L=this.diffData(o,I);Object.keys(L).length>0&&(v|=16),x.push.apply(x,[...Object.keys(L),...Object.keys(V),...R||[]]);let P={};for(let O=0;O<x.length;O++){let ee=x[O];P[ee]=f.state[ee]}f.updateDataToNative(this.filterReactComponentData(P),v,a);let w=this.componentEventBatch[t];w&&(this.componentEventBatch[t]=void 0,Array.isArray(w)&&w.forEach(O=>{this.publicComponentEvent(t,O.eventName,O.data)}));let J=n["react-ref"]||l["react-ref"];z(J)&&this.bindComponentWithRefId(i,t,J),this.lynx.performance.profileEnd()}onReactComponentRender(e,t,n,o){var v;let i=this.getComponent(e);if(!i){q("onReactComponentRender execution stopped because card creation failed");return}this.lynx.performance.profileStart(M.REACT_COMPONENT_RENDER,{args:{componentPath:i.componentPath}});let s=Hn(this._propsMap.getProps(t.propsId)),a;if((v=this.lynx._switches)!=null&&v.fixMergeOrder?a=Fe(t,s):a=Fe(s,t),Object.keys(a).forEach(x=>{i.props[x]=a[x]}),this.processVersionsAndCheckForConflict(n,i)){this.flushNative(i,32),this.lynx.performance.profileEnd();return}if(n&&typeof n=="object"&&Object.keys(n).forEach(x=>{ve(n[x])||(i.state[x]=n[x]),Le(i)&&G.syncInsHookState(i,n,!0)}),!o){this.lynx.performance.profileEnd();return}let l=!1;if(t.$$onlyPropsId)l=this.hasJSOnlyData(s);else{let x=Object.keys(s),T=Object.keys(t);l=x.filter(C=>!T.includes(C)||t[C]===null).length>0}let h={},d={};i.$hasDerivedFunction&&(!i.$shouldIgnoreLepusDataProcessor||l)?(h=i.$class.getDerivedStateFromProps(i.props,i.state),d=this.diffData(i.state,h),i.state=Object.assign(i.state,h||{})):i.$hasDerivedFunction&&(i.state=Object.assign(i.state,n||{}));let p=i.executeJSRender()||{};if(i.$throwError){this.lynx.performance.profileEnd();return}let u={};(i.$shouldDiffState||A(p)&&Object.keys(p).length>0)&&(u=this.diffData(i.state,p)),i.state=Object.assign(i.state,p||{});let _=0;Object.keys(d).length>0&&(_|=16),Object.keys(u).length>0&&(_|=4);let f=Object.assign(d,u);Object.keys(f).length&&i.updateDataToNative(f,_),this.lynx.performance.profileEnd()}processVersionsAndCheckForConflict(e,t){let n=!1;return e&&typeof e=="object"&&(pe in e&&(t.$nativeStateVersion=e[pe]),Re in e&&e[Re]<t.$jsStateVersion&&(n=!0),delete e[pe],delete e[Re]),n}flushNative(e,t,n=!1){let o={};e.$hasDerivedFunction&&(o=e.$class.getDerivedStateFromProps(e.props,e.state)),e.state=Object.assign(e.state,o||{}),e.state=Object.assign(e.state,e.executeJSRender()||{}),!e.$throwError&&e.updateDataToNative(this.filterReactComponentData(e.state),t,n)}flushAnonStateToNative(e){}reactUpdateComponent(e){let t=e.$hasUseDidUpdateLifecycleParams||typeof e.$hasUseDidUpdateLifecycleParams=="undefined";if(!e.$init)e.$init=!0,e.$hasDidUpdateLifecycleV2&&t&&(e.prevProps=Z(e.props),e.prevState=Z(e.state)),e.componentDidMount(),e.$componentState=1;else if(e.$isUpdatingState=!1,e.$hasDidUpdateLifecycleV2){let n=t?Z(e.props):void 0,o=t?Z(e.state):void 0;e.componentDidUpdate(e.prevProps,e.prevState),e.prevProps=n,e.prevState=o,e.$isUpdatingState?(e.$nestedUpdateCount+=1,e.$nestedUpdateCount>vn&&e.$startDetectNestedUpdateTimestamp===0&&(e.$startDetectNestedUpdateTimestamp=Date.now())):e.$nestedUpdateCount=0}Le(e)&&G.executeEffects(e),e.$catchError&&e.$hasDidCatchLifecycleV2&&(e.componentDidCatch(e.$catchError),e.$catchError=null)}onReactCardDidUpdate(){let e=this.appInstance;if(!e){q("onReactCardDidUpdate execution stopped because card creation failed");return}this.lynx.performance.profileStart(M.REACT_COMPONENT_DID_UPDATE,{args:{componentPath:"card"}}),this.reactUpdateComponent(e),this.lynx.performance.profileEnd(),this.lynx.nativeDataChanged=!1}onReactComponentDidUpdate(e){let t=this.getComponent(e);if(!t){q("onReactComponentDidUpdate execution stopped because card creation failed");return}this.lynx.performance.profileStart(M.REACT_COMPONENT_DID_UPDATE,{args:{componentPath:t.componentPath}}),this.reactUpdateComponent(t),this.lynx.performance.profileEnd()}onReactComponentDidCatch(e,t){let n=this.getComponent(e);if(!n){q("onReactComponentDidCatch execution stopped because card creation failed");return}this.lynx.performance.profileStart(M.REACT_COMPONENT_DID_CATCH,{args:{componentPath:n.componentPath}}),n.$hasDidCatchLifecycleV2&&n.componentDidCatch(t),this.lynx.performance.profileEnd()}onReactComponentUnmount(e){let t=this.getComponent(e);if(!t){q("onReactComponentUnmount execution stopped because card creation failed");return}if(this.lynx.performance.profileStart(M.REACT_COMPONENT_UNMOUNT,{args:{componentPath:t.componentPath}}),A(t.__childrenPropsIds))Object.keys(t.__childrenPropsIds).forEach(n=>{this._propsMap.deleteProps(n)}),t.__childrenPropsIds={};else{let n=t.props?t.props.propsId:null;n&&this._propsMap.deleteProps(n)}Le(t)&&G.cleanUpHooks(t),t.componentWillUnmount(),t.clearRefToThis(),t.$componentState=2,delete this._componentInstance[e],this.lynx.performance.profileEnd()}setComponent(e,t,n){this._componentInstance[e]=t,t.parentId=n}getComponent(e){return this._componentInstance[e]}getComponentOptions(e,t){return t?this._dynamicComponentMap[t][e]:this._dynamicComponentMap[ae][e]}callBeforePublishEvent(e){if(this._aopManager._beforePublishEvent.getEventsSize(e.type)!==0){let t=N({},e);try{this._aopManager._beforePublishEvent.emit(t.type,[t])}catch(n){this.handleUserError(n,{by:"callBeforePublishEvent",type:t.type})}}}publishEvent(e,t){let o=this.appInstance;try{if(this.callBeforePublishEvent(t),typeof o[e]=="function")return this.handlerEvent(o,e,t);throw new Error(`Do not have ${e} method in Card`)}catch(i){this.handleUserError(i,{handlerName:e})}}publicComponentEvent(e,t,n){let o=this,i=o.getComponent(e);if(!i){o.saveComponentEventBatch(e,t,n);return}try{if(this.callBeforePublishEvent(n),typeof i[t]=="function")return o.handlerEvent(i,t,n)}catch(s){this.handleUserError(s,{by:t,componentId:e})}}handlerEvent(e,t,n){let o=this,i="funPrivate",s=e,a=[],c=[],l={},h=n.type,d=n.currentTarget.dataset||{};n.preventDefault=()=>{},n.stopPropagation=()=>{},n.stopImmediatePropagation=()=>{},Object.keys(d).forEach(u=>{let _=u.toLocaleLowerCase();if(/^e/.test(_)&&(_=_.replace(/^e/,""),_.indexOf(h)>=0)){let f=_.replace(h,"");/^(a[a-z]|so)$/.test(f)&&(l[f]=d[u])}});let p=null;return"so"in l&&(s=l.so!=="this"?l.so:e,p=l.so!=="this"?l.so:null,delete l.so),A(l)&&(c=Object.keys(l).sort().map(u=>l[u])),t.indexOf(i)===-1?a=[...c,n]:a=[p,...c,n],e[t].apply(s,a)}callDestroyLifetimeFun(){try{Object.keys(this._componentInstance).forEach(t=>{this.onReactComponentUnmount(t)}),this.appInstance.componentWillUnmount()}catch(e){}}destroy(){try{Le(this.appInstance)&&G.cleanUpHooks(this.appInstance),this.modules=null,this._params=null,this._componentMap=null,this._propsMap=null,this.appInstance=null,this.componentEventBatch=null,super.destroy()}catch(e){}}onAppEnterBackground(e){let t=this;try{t.appInstance&&j(this.appInstance.componentDidHide)&&t.appInstance.componentDidHide(),this.GlobalEventEmitter.emit("onHide",e)}catch(n){this.handleUserError(n)}}onAppEnterForeground(e){let t=this;try{t.appInstance&&j(this.appInstance.componentDidShow)&&t.appInstance.componentDidShow(),this.GlobalEventEmitter.emit("onShow",e)}catch(n){this.handleUserError(n)}}dispatchError(e){this.appInstance&&j(this.appInstance.componentDidCatch)&&this.appInstance.componentDidCatch(e)}onAppReload(e){var t,n;(t=this.appInstance)==null||t.componentWillUnmount(),this.appInstance.$componentState=2,this._propsMap.clear(),(n=this.lynx._switches)!=null&&n.enableClearGlobalEventsInReload&&this.GlobalEventEmitter.removeAllListeners(),this._params.updateData=e,this.Card(this._cardComponentClass)}require(e,t){let n=t&&t.dynamicComponentEntry?t.dynamicComponentEntry:ae;return super.require(e,{dynamicComponentEntry:n,ReactLynx:this._reactLynx})}define(e,t,n){super.define(e,t,n)}bindComponentWithRefId(e,t,n){for(let i=this._componentInstance[e];i;i=this._getComponent(i.parentId)){let s=i.$refs.find(a=>a.refId===n);if(A(s)){this._componentInstance[t].$componentIdContainsRefToThis={componentId:i.componentId,refItem:s},i.$pureData[n]=t,i.bindSingleRef(s);return}}let o=this.appInstance.$refs.find(i=>i.refId===n);A(o)&&(this._componentInstance[t].$componentIdContainsRefToThis={componentId:"card",refItem:o},this.appInstance.$pureData[n]=t,this.appInstance.bindSingleRef(o))}OnLifecycleEvent(e){}addInternalEventListeners(){super.addInternalEventListeners(),this.addInternalEventListener(W.CoreContext,F.ON_REACT_COMPONENT_RENDER,e=>{let[t,n,o,i]=e.data;this.onReactComponentRender(t,n,o,i)}),this.addInternalEventListener(W.CoreContext,F.ON_REACT_COMPONENT_DID_UPDATE,e=>{let t=e.data;this.onReactComponentDidUpdate(t)}),this.addInternalEventListener(W.CoreContext,F.ON_REACT_COMPONENT_DID_CATCH,e=>{let[t,n]=e.data;this.onReactComponentDidCatch(t,n)}),this.addInternalEventListener(W.CoreContext,F.ON_REACT_CARD_DID_UPDATE,()=>{this.onReactCardDidUpdate()}),this.addInternalEventListener(W.CoreContext,F.ON_REACT_COMPONENT_CREATED,e=>{this.nativeApp.pauseGcSuppressionMode();try{let[t,n,o,i,s,a,c]=e.data;this.onReactComponentCreated(n,o,i,s,a,t===""?void 0:t,c)}finally{this.nativeApp.resumeGcSuppressionMode()}}),this.addInternalEventListener(W.CoreContext,F.ON_REACT_CARD_RENDER,e=>{let[t,n,o]=e.data;this.onReactCardRender(t,n,o)}),this.addInternalEventListener(W.CoreContext,F.ON_REACT_COMPONENT_UNMOUNT,e=>{this.onReactComponentUnmount(e.data),this.forceGcJSIObjectWrapper()})}};function Jt(r,e){let t="__lynx_timing_flag",n=["update_set_state_trigger","update_diff_vdom_start","update_diff_vdom_end"];e[t]&&n.forEach(o=>{r.markTiming(e[t],o)})}var Kt="__lynx_data_version";var pt=class extends Ee{get __proxy(){return this.getApp()}constructor(e,t,n,o){super({type:"card",resolvedPromise:n,app:o});let i=this;this.$parent=null,i.$children=[],i._queue=[],i._microTaskPending=!1,i._nativeApp=t,this._options=e;let d=e,{data:s={},theme:a={},methods:c={}}=d,l=On(d,["data","theme","methods"]);i.data=N({},s),i.theme=N({},a),i.methods=N({},c),i._uiModule=this._nativeApp.nativeModuleProxy.LynxUIMethodModule;let h=Object.assign({},En,l);Object.keys(c).forEach(function(p){typeof c[p]=="function"&&(i[p]=$(`at Card methods: ${p}`,i,c[p]).bind(i))}),Object.keys(h).forEach(p=>{typeof h[p]=="function"?i[p]=$(`at Card ${p}`,i,h[p]).bind(i):i[p]=Z(h[p])}),this.GlobalEventEmitter=o.GlobalEventEmitter,this.performance=o.performance}setData(e,t){var o,i;let n=this;if(this.cardState!=="destroyed")try{let s=D(e);if(s!=="object")throw new Error(`setData's first param must be object, you pass ${s}`);let a=D(t);if(t&&a!=="function")throw new Error(`setData's second param must be function, you pass ${a}`);let c=(o=n.getApp().lynx._switches)==null?void 0:o.enableLynxNodiff;c&&Jt(n._nativeApp,e),super.updateData(e),super.dataQueueUpdate(n,e,{callback:$("at card setData/dataQueueUpdate",n,t).bind(n),enableFixBatchedUpdateOrder:(i=this.__proxy.lynx._switches)==null?void 0:i.enableFixBatchedUpdateOrder,updateDataType:1,updateToNative:c?this.__proxy.updateSignals.bind(this.__proxy):void 0})}catch(s){this.getApp().handleInternalError(s)}}getNodeRef(e){return new se({nativeLynxUIModule:this._uiModule,nativeApp:this._nativeApp,disableWarningWhenFailed:this.__proxy.lynx._switches.disableNodeRefWarningWhenFailed},"",e)}createSelectorQuery(e){return e?H.fromQuery(e,this.componentId):H.newEmptyQuery({nativeApp:this._nativeApp,lynx:this.__proxy.lynx})}getElementById(e){return new de("card",e,this.__proxy.lynx)}getRoot(){return new de("card",void 0,this.__proxy.lynx)}selectComponent(e,t){let n=this,o=D(t);if(t&&o!=="function")throw new Error(`selectComponent's second param must be function, you pass ${o}`);let i=s=>{Array.isArray(s)&&t(this.__proxy.getComponent(s[0]))};this._nativeApp.selectComponent("card",e,!0,$("at card selectComponent",n,i).bind(n))}updateTheme(e,t=!1){let n=this;try{let o=D(e);if(o!=="object")throw new Error(`updateTheme's first param must be object, you pass ${o}`);let i={};t?Object.assign(i,e):Object.assign(i,n.theme,e),Object.keys(i).forEach(s=>{i[s]||delete i[s]}),n._nativeApp.updateData({__card_config_:{theme:i}},1)}catch(o){this.getApp().handleInternalError(o)}}registerModule(e,t){return this.__proxy.registerModule(e,t)}getJSModule(e){return this.__proxy.getJSModule(e)}addGlobalEventListener(e,t,n){this.getJSModule("GlobalEventEmitter").addListener(e,t,n)}setSharedData(e,t){y.sharedData[e]=t}getSharedData(e){return y.sharedData[e]}};function Dr(r){return N({},r)}var Nr=new Map;function Ro(r){let e={created:[r.created],attached:[r.attached],ready:[r.ready],moved:[r.moved],detached:[r.detached]};Array.isArray(r.behaviors)&&qn(r.behaviors,t=>{let n=Nr.get(t);n&&He.forEach(o=>{typeof n[o]=="function"&&e[o].push(n[o])})}),He.forEach(t=>{r[t]=function(...n){e[t].forEach(o=>o.apply(this,n))}})}function Pr(r,e="Behavior"){let{created:t=ue,attached:n=ue,ready:o=ue,moved:i=ue,detached:s=ue}=r||{};r=N({},r);let a=Object.assign(r,{created:t,attached:n,ready:o,moved:i,detached:s}),c=N({},a);return Ro(c),c}function Lr(r){try{if(A(r)){let e=Vn(),t=Object.keys(r).reduce(function(n,o){return He.includes(o)&&typeof r[o]=="function"&&(n[o]=r[o]),n},{});return Nr.set(e,t),e}}catch(e){this.handleInternalError(e)}}var lt=class extends Ee{constructor(e,t,n,o){super({type:"component",componentId:e,resolvedPromise:o,app:t});let i=this,s=Z(n);s=Pr(s);let a=s.methods||{},c=s.pageLifetimes||{},l=s.lifetimes||{};i.$parent=null,i.$children=[],i._initDataUpdated=!1,i._appInstance=t.appInstance,i._proxyInstance=t,i.componentId=e,i.behaviors=s.behaviors||[],i._nativeApp=t.nativeApp,i._lifetimes=l,i._pageLifetimes=c,i._uiModule=i._nativeApp.nativeModuleProxy.LynxUIMethodModule,this.GlobalEventEmitter=t.GlobalEventEmitter,A(s.data)||(s.data={}),A(s.properties)||(s.properties={});let h=s.data;i._jsInitData=N({},h);for(let d in s.properties)h[d]=s.properties[d].value;i.data=i.properties=h,i._properties=s.properties||{},Object.keys(a).forEach(d=>{typeof a[d]=="function"&&(i[d]=$(`at component methods ${d}`,i._appInstance,a[d]).bind(i))}),Object.keys(s).forEach(function(d){var p,u,_;typeof s[d]=="function"?i[d]=$(`at component option ${d}`,i._appInstance,s[d]).bind(i):(_=(u=(p=i._proxyInstance)==null?void 0:p.lynx)==null?void 0:u._switches)!=null&&_.enableCopyOptions&&!["data","properties","methods"].includes(d)&&(i[d]=Z(s[d]))})}updateInitData(){var l,h;if(this._initDataUpdated)return;let{componentId:e,_jsInitData:t,_nativeInitData:n={}}=this,o=this.getApp().lynx._switches.enableLynxNodiff,i=this.getApp().lynx.performance._initializeAndStartPipeline(),s=o?this._proxyInstance.updateSignal.bind(this._proxyInstance):this._nativeApp.updateComponentData;if(!((h=(l=this._appInstance.__proxy.lynx)==null?void 0:l._switches)!=null&&h.enableReduceInitDataCopy)){s(e,t,null,2,...o?["component",i]:[]),this._initDataUpdated=!0;return}let a=Array.isArray(n)?n:Object.keys(n).filter(d=>!Et(n[d])),c=Or(a,t);Object.keys(c).length>0&&s(e,c,null,2,...o?["component",i]:[]),this._initDataUpdated=!0}getNodeRef(e){return new se({nativeLynxUIModule:this._uiModule,nativeApp:this._nativeApp,disableWarningWhenFailed:this._proxyInstance.lynx._switches.disableNodeRefWarningWhenFailed},this.componentId,e)}getNodeRefFromRoot(e){return new se({nativeLynxUIModule:this._uiModule,nativeApp:this._nativeApp,disableWarningWhenFailed:this._proxyInstance.lynx._switches.disableNodeRefWarningWhenFailed},"",e)}createSelectorQuery(e){return e?H.fromQuery(e,this.componentId):H.newEmptyQuery({nativeApp:this._nativeApp,lynx:this._proxyInstance.lynx},this.componentId)}getPathFromTarget(e,t){this.createSelectorQuery().selectUniqueID(e.uid).path(t).exec()}getElementById(e){return new de(this.componentId,e,this._proxyInstance.lynx)}selectComponent(e,t){let n=this,o=D(t);if(t&&o!=="function")throw new Error(`selectComponent's second param must be function, you pass ${o}`);let i=s=>{Array.isArray(s)&&t(this._proxyInstance.getComponent(s[0]))};this._nativeApp.selectComponent(this.componentId,e,!0,$("at component selectComponent",n,i).bind(n))}getJSModule(e){return this._proxyInstance.getJSModule(e)}setData(e,t){var o,i;let n=this;try{let s=D(e);if(s!=="object")throw new Error(`setData's first param must be object, you pass ${s}`);let a=D(t);if(t&&a!=="function")throw new Error(`setData's second param must be function, you pass ${a}`);n._initDataUpdated||this.updateInitData();let c=(o=n.getApp().lynx._switches)==null?void 0:o.enableLynxNodiff;c&&Jt(n._nativeApp,e),super.updateData(e,this.data),super.dataQueueUpdate(n._appInstance,e,{callback:$("at Component setData",n._appInstance,t).bind(n),enableFixBatchedUpdateOrder:(i=n._proxyInstance.lynx._switches)==null?void 0:i.enableFixBatchedUpdateOrder,updateDataType:1,updateToNative:c?this._proxyInstance.updateSignals.bind(this._proxyInstance):void 0})}catch(s){this.getApp().handleUserError(s,{componentId:this.componentId})}}triggerEvent(e,t={},n={}){let o=this;try{let{componentId:i}=o;o._nativeApp.triggerComponentEvent(e,{eventDetail:t,eventOption:n,componentId:i})}catch(i){this.getApp().handleInternalError(i,{componentId:this.componentId})}}};function Mr(r,e,t,n,o){var l;let i=this,{initData:s,entryName:a,parentId:c}=o||{};try{if(!He.includes(e))return;if(e==="created"){n.startsWith("/")&&(n=n.substr(1));let p=i.getComponentOptions(n,a),u=null;if(A(p))try{u=new lt(t,i,p,r)}catch(f){throw new Error(`create component error: ${f}`)}else throw new Error(`component: ${n} is not exist!`);let _=(l=i.lynx._switches)!=null&&l.enableCardReuse?i.getEncodeInitData(a)[n]:s;if(A(_)?(u._nativeInitData=_,Object.keys(_).forEach(f=>{Te(u.data,f)||(u.data[f]=_[f])})):ge(_)&&(u._nativeInitData=_,u.data.__globalProps=i.lynx.__globalProps,u.data.SystemInfo=y.SystemInfo),z(c)){let f=null;c==="card"?f=i.appInstance:f=i.getComponent(c),f&&(u.$parent=f,f.$children.push(u))}i.setComponent(t,u)}let h=i.getComponent(t);if(e==="attached"&&!h._initDataUpdated){let p=!0;i.allRemoved&&(p=!i.allRemoved[n]),p&&h.updateInitData(),h._initDataUpdated=!0}if(!h)throw new Error(`component instance: ${t} is not exist`);Ao(h,e);let d=(h._lifetimes||{})[e]||h[e];if(typeof d=="function"&&d(o),e==="detached"){let p=h.$parent,u=(p||{}).$children;if(Array.isArray(u)){let _=[];u.forEach(function(f){f.componentId!==t&&_.push(f)}),p.$children=_}h.$parent=null,this.detachComponent(t)}}catch(h){this.handleUserError(h,{action:e,componentId:t,route:n})}}function Ao(r,e){e==="attached"?r.componentState=B.attached:e==="detached"?r.componentState=B.detached:e==="ready"?(r.componentState=B.ready,r.$_internal_shouldStopBatching=!0):e==="moved"?r.componentState=B.moved:e==="created"&&(r.componentState=B.created)}function ye(r,e={}){let n=this._componentInstance||{};Object.keys(n).forEach(function(o){let i=n[o],s=(i._pageLifetimes||{})[r];typeof s=="function"&&s.call(i,e)})}var dt=class extends ce{constructor(e,t){super(e,t),this._componentOpts={},this._componentInstance={},this._dataProcessor={},this._encodeInitData={},this._dataVersion=-1}setAllRemoved(e){this.allRemoved=e}handleError(e,t,n){super.handleError(e,t,n),!this.$isErrorHandling&&(this.$isErrorHandling=!0,this._appInstance&&j(this._appInstance.onError)&&this._appInstance.onError(e.message||e.stack,t),this.$isErrorHandling=!1)}require(e,t){let n=y.globDynamicComponentEntry?y.globDynamicComponentEntry:ae;return super.require(e,{dynamicComponentEntry:n,ReactLynx:y.TaroLynx})}define(e,t){super.define(e,t,y.globDynamicComponentEntry)}Card(e){var o;let t=this,{globComponentRegistPath:n}=y;this._cardPath=n,this._cardParams=e;try{let{initData:i,updateData:s,processorName:a="default",cacheData:c=[],isReload:l}=t._params||{};t._appInstance=new pt(e,t._nativeApp,this.resolvedPromise,t);let h=(o=t.lynx._switches)!=null&&o.enableCardReuse?t.getEncodeInitData()[n]:i;h&&typeof h=="object"&&t.initCardData(h),(t.enableJSDataProcessor()||s&&typeof s=="object")&&t.updateCardData(s,{processorName:a,cacheData:c,fromCard:!0,isReload:l}),t.onCardLoad()}catch(i){this.handleUserError(i)}finally{return e}}onCardLoad(){let e=this,{initConfig:t}=e._params||{};t&&typeof t=="object"&&e.processCardConfig(t),e._appInstance.cardState="loaded",e._appInstance.onLoad({}),ye.call(e,"onLoad")}Behavior(e){return Lr.call(this,e)}Component(e){let{globDynamicComponentEntry:t,globComponentRegistPath:n}=y,o=Dr(e);return t||(t=ae),this._componentOpts[t]||(this._componentOpts[t]={}),this._componentOpts[t][n]=o,o}setComponent(e,t){this._componentInstance[e]=t}getComponent(e){return this._componentInstance[e]}detachComponent(e){delete this._componentInstance[e]}getComponentOptions(e,t){let n=null;try{n=t?this._componentOpts[t][e]:this._componentOpts[ae][e]}catch(o){throw new Error(`Component (${e}) is not register. 
 please use Component({...}) to register.`)}return n}callDestroyLifetimeFun(){try{ye.call(this,"onDestroy"),this._appInstance.onDestroy()}catch(e){}}destroy(){try{this.modules=null,this._appInstance.cardState="destroyed",this._appInstance=null,this.resolvedPromise=null,super.destroy()}catch(e){}}callBeforePublishEvent(e){if(this._aopManager._beforePublishEvent.getEventsSize(e.type)!==0){let t=N({},e);try{this._aopManager._beforePublishEvent.emit(t.type,[t])}catch(n){this.handleUserError(n,{by:"callBeforePublishEvent",type:t.type})}}}publishEvent(e,t){let o=this._appInstance,i=o._options[e];try{if(this.callBeforePublishEvent(t),typeof o[e]=="function")return o[e](t);if(typeof i=="function")return i.call(o,t);throw new Error(`Do not have ${e} method in Card`)}catch(s){this.handleUserError(s,{handlerName:e})}}publicComponentEvent(e,t,n){let o=this,i=o.getComponent(e);if(!i||!i.$_internal_shouldStopBatching){o.saveComponentEventBatch(e,t,n);return}try{if(this.callBeforePublishEvent(n),typeof i[t]=="function")return i[t](n)}catch(s){this.handleUserError(s,{handlerName:t,componentId:e})}}onComponentActivity(e,t,n,o){Mr.call(this,this.resolvedPromise,e,t,n,o);let i=this.getComponent(t);if(i&&i.$_internal_shouldStopBatching){let s=this.componentEventBatch[t];this.componentEventBatch[t]=void 0,Array.isArray(s)&&s.forEach(a=>{this.publicComponentEvent(t,a.eventName,a.data)})}}onComponentPropertiesChanged(e,t){let o=this.getComponent(e);try{let i=o.properties,s=[];A(t)&&(Object.keys(t).forEach(a=>{var d;let c=i[a],l=t[a],h=!1;(d=this.lynx._switches)!=null&&d.enableDeepDiffProperties?Je(c,l)||(h=!0):c!==l&&(h=!0),h&&(o.data[a]=o.properties[a]=l,s.push([c,l,a]))}),s.length>0&&s.forEach(([a,c,l])=>{let h=o._properties[l]||{},{observer:d}=h;A(h)&&(z(d)&&(d=o[d]),typeof d=="function"&&d.call(o,c,a))}))}catch(i){this.handleUserError(i,{componentId:e})}}onComponentDatasetChanged(e,t){let o=this.getComponent(e);try{o.dataset=t}catch(i){this.handleUserError(i,{componentId:e})}}onComponentInstanceChanged(e,t){let o=this.getComponent(e);try{o.className=t.className,o.idSelector=t.id}catch(i){this.handleInternalError(i,{componentId:e})}}updateCardData(e,t){let n=this,{type:o=0,processorName:i="default",cacheData:s=[]}=t||{};n._updateData=e=n.processData(e,i,s);try{let a=n._appInstance;o==1&&(a.data={__globalProps:a.data.__globalProps},this._initData&&typeof this._initData=="object"&&Object.keys(this._initData).forEach(c=>{a.data[c]=this._initData[c]})),typeof e=="string"&&(e=JSON.parse(e)),e&&typeof e=="object"&&Object.keys(e).forEach(c=>{let l=e[c];a.data[c]=l}),this.onCardDataChanged(e,t)}catch(a){this.handleUserError(a)}}onCardDataChanged(e,t){var o;(o=this.lynx._switches)!=null&&o.enableLynxNodiff&&e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,Kt)&&(this._dataVersion=e[Kt],delete e[Kt]);let n=this._appInstance;typeof n.onDataChanged=="function"&&n.onDataChanged.call(n,e)}initCardData(e){this._initData=e;let t=this;try{let n=t._appInstance;Object.keys(e).forEach(o=>{Te(n.data,o)||(n.data[o]=e[o])})}catch(n){this.handleInternalError(n)}}enableJSDataProcessor(){var e,t;return((e=this.lynx._switches)==null?void 0:e.enableLynxNodiff)&&((t=this.lynx._switches)==null?void 0:t.enableJSDataProcessor)}setDataProcessor(e,t="default"){this._dataProcessor[t]=e}processData(e,t,n){var o,i,s;if(this.enableJSDataProcessor()){let a={};n==null||n.reduce((c,l)=>Object.assign(c,this.processData(l.data,l.processorName||"default")),a);try{return Object.assign(a,(s=(i=(o=this._dataProcessor)[t||"default"])==null?void 0:i.call(o,e,{__globalProps:this.lynx.__globalProps,SystemInfo:y.SystemInfo}))!=null?s:e)}catch(c){return this.handleUserError(c),Object.assign(a,e)}}return e}setEncodeInitData(e){let t=this.getEntryName();this._encodeInitData[t]=e}getEncodeInitData(e){let t=e||this.getEntryName();return this._encodeInitData[t]||{}}getEntryName(){return y.globDynamicComponentEntry?y.globDynamicComponentEntry:ae}onNativeAppReady(e){var o;let t=this,n=this.lynx.performance._initializeAndStartPipeline();try{let i=!0;if(t.allRemoved&&(i=!t.allRemoved["/"+this._cardPath]),i){let s=Object.assign({},this._initData,this._updateData),a=this.diffData(s,this._appInstance.data);Object.keys(a).length>0&&((o=this.lynx._switches)!=null&&o.enableLynxNodiff?t.updateSignal("0",a,()=>{},2,"card",n):t._nativeApp.updateData(a,2,()=>{}))}t._appInstance.cardState="ready",t._appInstance.onReady({}),ye.call(t,"onReady")}catch(i){this.handleUserError(i)}}updateLepusSignal(e,t=!0){let{componentId:n,data:o,callback:i,type:s,updateDataType:a,stackTraces:c,pipelineOptions:l}=e||{},h=[];for(let d in o)h.push([yn(d),o[d]]);this.nativeApp.callLepusMethod("updateSignal",{paths:h,componentId:s==="card"?"0":n,isFinished:t,updateDataType:a,dataVersion:s==="card"?this._dataVersion:void 0,pipelineOptions:l},i,n,c)}updateSignal(e,t,n,o,i,s){this.lynx.performance.profileStart(M.TT_UPDATE_SIGNAL);let a={componentId:e,data:t,callback:n,updateDataType:o,type:i||"component",pipelineOptions:s};this.updateLepusSignal(a),this.lynx.performance.profileEnd()}updateSignals(e){this.lynx.performance.profileStart(M.TT_UPDATE_SIGNALS);let t=e.length;e.forEach((n,o)=>{this.updateLepusSignal(n,o===t-1)}),this.lynx.performance.profileEnd()}onAppEnterBackground(e){let t=this;try{t._appInstance.onHide(),ye.call(t,"onHide")}catch(n){this.handleUserError(n)}}onAppEnterForeground(e){let t=this;try{t._appInstance.onShow(e),ye.call(t,"onShow")}catch(n){this.handleUserError(n)}}onAppFirstScreen(){let e=this;try{this._appInstance.onFirstScreen(),ye.call(e,"onFirstScreen")}catch(t){this.handleUserError(t)}}onAppReload(e,t){var n,o;ye.call(this,"onDestroy"),(n=this.appInstance)==null||n.onDestroy(),this.appInstance.cardState="destroyed",(o=this.lynx._switches)!=null&&o.enableClearGlobalEventsInReload&&this.GlobalEventEmitter.removeAllListeners(),this._params.updateData=e,this._params.processorName=(t==null?void 0:t.processorName)||"default",this._params.isReload=!0,y.globComponentRegistPath=this._cardPath,this.Card(this._cardParams),this._params.isReload=!1}OnLifecycleEvent(e){try{if(!ge(e))throw new Error(`OnLifecycleEvent should get an array as argument, but get ${D(e)}`);let[t,n,o]=e;ge(n)||(n=[n]),n.forEach(i=>{switch(i){case B.created:case B.attached:case B.detached:case B.ready:case B.moved:this.onComponentActivity(i,t,o.path,o);break;case"datasetChanged":this.onComponentDatasetChanged(t,o.dataset);break;case"instanceChanged":this.onComponentInstanceChanged(t,o);break;case"propertiesChanged":this.onComponentPropertiesChanged(t,o.props);break;default:throw new Error(`OnLifecycleEvent unknown event: ${i}`)}})}catch(t){this.handleInternalError(t)}}addInternalEventListeners(){super.addInternalEventListeners(),this.addInternalEventListener(W.CoreContext,F.ON_COMPONENT_ACTIVITY,e=>{let[t,n,o,i,s,a]=e.data,c;t===B.created&&a!==void 0&&(c={initData:a,entryName:s,parentId:o}),this.onComponentActivity(t,n,i,c),t===B.detached&&this.forceGcJSIObjectWrapper()}),this.addInternalEventListener(W.CoreContext,F.ON_COMPONENT_SELECTOR_CHANGED,e=>{let[t,n]=e.data;this.onComponentInstanceChanged(t,n)}),this.addInternalEventListener(W.CoreContext,F.ON_COMPONENT_PROPERTIES_CHANGED,e=>{let[t,n]=e.data;this.onComponentPropertiesChanged(t,n)}),this.addInternalEventListener(W.CoreContext,F.ON_COMPONENT_DATA_SET_CHANGED,e=>{let[t,n]=e.data;this.onComponentDatasetChanged(t,n)})}};var ht=class extends ce{constructor(e,t){super(e,void 0),this.fillSingletonData();try{t.srcName&&(delete this.lynx.requireModule.cache[t.srcName],delete ce._$factoryCache[t.srcName],this.lynx.requireModule(t.srcName,ae),this.dataTypeSet.add("undefined"))}catch(n){this.handleUserError(n)}}fillSingletonData(){this.singletonData=new jt,this.singletonData.nativeApp=this._nativeApp,this.singletonData.sharedConsole=this.sharedConsole,this.singletonData.dynamicComponentExports=this.dynamicComponentExports,this.singletonData.loadedDynamicComponentsSet=this.loadedDynamicComponentsSet,this.singletonData.intersectionObserverManager=this._intersectionObserverManager,this.singletonData.exposureManager=this._exposureManager,this.singletonData.textInfoManager=this._textInfoManager,this.singletonData.globalEventEmitter=this.GlobalEventEmitter,this.singletonData.aopManager=this._aopManager,this.singletonData.performance=this.performance,this.singletonData.modules=this.modules,this.singletonData.lazyCallableModules=this._lazyCallableModules,this.singletonData.lynx=this.lynx,this.singletonData.apiList=this._apiList,this.singletonData.Reporter=this.Reporter,this.singletonData.callbackManager=this._callbackManager,this.singletonData.setTimeout=this.setTimeout,this.singletonData.setInterval=this.setInterval,this.singletonData.clearInterval=this.clearInterval,this.singletonData.clearTimeout=this.clearTimeout,this.singletonData.resolvedPromise=this.resolvedPromise,this.singletonData._createReadableStreamClass=this._createReadableStreamClass,this.singletonData._ReadableStreamClass=this._ReadableStreamClass}};function wr(nativeApp,params,lynx){var r,e,t,n;let{cardType}=params,tt,{id}=nativeApp;q(`load card native app id: ${id} cardType ${cardType}`);let loadSuccess=!0;try{if(cardType=="standalone"?tt=new ht({nativeApp,params,lynx},params):cardType==="tt"?tt=new dt({nativeApp,params,lynx},(e=(r=y)==null?void 0:r.multiApps[id])==null?void 0:e.singletonData):tt=new ct({nativeApp,params,lynx},(n=(t=y)==null?void 0:t.multiApps[id])==null?void 0:n.singletonData),y.currentAppId=id,y.multiApps[id]=tt,cardType==="standalone")return nativeApp.setCard(tt),!0;let{BDLynxSDKCore}=y,{apiInit,registerNativeEvent}=BDLynxSDKCore||{};if(typeof apiInit=="function"){let o=apiInit.call(tt);tt.apiList=o}if(tt.registerModule("BDLynxAPIModule",new _e),typeof registerNativeEvent=="function"&&registerNativeEvent(tt.getJSModule("BDLynxAPIModule")),q(`load card native app load app-service.js params.bundleSupportLoadScript ${params.bundleSupportLoadScript}`),params.bundleSupportLoadScript){try{delete tt.lynx.requireModule.cache[fe],delete ce._$factoryCache[fe],tt.lynx.requireModule(fe,X),tt.lynx._switches.allowUndefinedInNativeDataTypeSet&&tt.dataTypeSet.add("undefined")}catch(o){loadSuccess=!1,tt.handleUserError(o,void 0,void 0,"loadCard failed")}nativeApp.setCard(tt)}else{nativeApp.featureCount(Be.TypescriptBundleSupportLoadScript);let jsContent=nativeApp.readScript(fe);eval(jsContent),q("load card load app-service.js eval success"),nativeApp.setCard(tt)}}catch(o){ur(nativeApp,o),loadSuccess=!1}return loadSuccess}y.loadCard=wr;y.destroyCard=un;y.callDestroyLifetimeFun=fn;y.loadDynamicComponent=_n;y.__createEventEmitter=rn;y.__lynxArrayBufferToBase64=dr;y.__lynxBase64ToArrayBuffer=hr;y.LynxSDKCore={report:nn,reportInner:Xn,reportUser:$};y.Headers=Oe;y.AbortController=Nt;y.AbortSignal=De;y.URL=Mt;rr(y);y.__invokeAppMethod=mn;})();
